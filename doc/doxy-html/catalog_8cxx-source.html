<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>catalog.cxx Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>catalog.cxx</h1><a href="catalog_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00014 <span class="preprocessor">#include "<a class="code" href="catalog_8h.html">catalog.h</a>"</span>
00015 
<a name="l00016"></a><a class="code" href="namespacecatalog_access.html">00016</a> <span class="keyword">namespace </span>catalogAccess {
00017 
00018 <span class="comment">/**********************************************************************/</span>
00019 <span class="comment">/*  DEFINING CLASS CONSTANTS                                          */</span>
00020 <span class="comment">/**********************************************************************/</span>
00021 
00022 <span class="comment">// available mirror sites for VizieR (from CDS)</span>
<a name="l00023"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r0">00023</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogURL[<a class="code" href="catalog_8h.html#a2">MAX_URL</a>]={
00024       <span class="stringliteral">"cds   fr vizier.u-strasbg.fr/"</span>,    <span class="comment">//CDS - Strasbourg, France</span>
00025       <span class="stringliteral">"cfa   us vizier.cfa.harvard.edu/"</span>, <span class="comment">//CFA - Harvard, USA</span>
00026       <span class="stringliteral">"cadc  ca vizier.hia.nrc.ca/"</span>,      <span class="comment">//CADC - Canada</span>
00027       <span class="stringliteral">"adac  jp vizier.nao.ac.jp/"</span>,       <span class="comment">//ADAC - Tokyo, Japan</span>
00028       <span class="stringliteral">"ukirt hawaii www.ukirt.jach.hawaii.edu/"</span>, <span class="comment">//JAC - Hawaii, USA</span>
00029       <span class="stringliteral">"cambridge uk archive.ast.cam.ac.uk/"</span>,
00030       <span class="stringliteral">"iucaa in urania.iucaa.ernet.in/"</span>,  <span class="comment">//IUCAA - Pune, India</span>
00031       <span class="stringliteral">"moscow ru www.inasan.rssi.ru/"</span>,    <span class="comment">//INASAN - Russia (DOES IT WORK ?)</span>
00032       <span class="stringliteral">"bejing cn data.bao.ac.cn/"</span>         <span class="comment">//Bejing Obs. - China</span>
00033       };
00034 
00035 <span class="comment">// information on catalog size laste updated on: JAN 2005</span>
<a name="l00036"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r1">00036</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogList[2*<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>]={
00037       <span class="stringliteral">"EGRET3 sources"</span>, <span class="stringliteral">"J/ApJS/123/79/3eg"</span>,    <span class="comment">//   271 rows (20 columns)</span>
00038       <span class="stringliteral">"EGRET3 fluxes"</span>,  <span class="stringliteral">"J/ApJS/123/79/fluxes"</span>, <span class="comment">//  5245 rows (10 columns)</span>
00039       <span class="stringliteral">"EGRET3 periods"</span>, <span class="stringliteral">"J/ApJS/123/79/table1"</span>, <span class="comment">//   169 rows ( 6 columns)</span>
00040       <span class="stringliteral">"ROSAT 1RXS"</span>,     <span class="stringliteral">"IX/10A/1rxs"</span>,          <span class="comment">// 18806 rows (28 columns)</span>
00041       <span class="stringliteral">"Veron (11th) quasar"</span>, <span class="stringliteral">"VII/235/table1"</span>,  <span class="comment">// 48921 rows (21 columns)</span>
00042       <span class="stringliteral">"Veron (11th) BL Lac"</span>, <span class="stringliteral">"VII/235/table2"</span>,  <span class="comment">//   876 rows (21 columns)</span>
00043       <span class="stringliteral">"Veron (11th) AGN"</span>,    <span class="stringliteral">"VII/235/table3"</span>,  <span class="comment">// 15069 rows (21 columns)</span>
00044       <span class="stringliteral">"WGACAT of ROSAT"</span>,     <span class="stringliteral">"IX/31/wgacat"</span>,    <span class="comment">// 88621 rows (101 columns)</span>
00045       <span class="stringliteral">"ROSAT faint sources"</span>, <span class="stringliteral">"IX/29/rass_fsc"</span>,  <span class="comment">//105924 rows (30 columns)</span>
00046       <span class="stringliteral">"Green galactic SNR"</span>,  <span class="stringliteral">"VII/227/snrs"</span>     <span class="comment">//   231 rows (14 columns)</span>
00047       };
00048 
00049 
<a name="l00050"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r2">00050</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogGeneric[<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>][<a class="code" href="catalog_8h.html#a1">MAX_GEN</a>]={
00051      {<span class="stringliteral">"3EG"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"theta95"</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00052      {<span class="stringliteral">"3EG"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>},
00053      {<span class="stringliteral">""</span>,    <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00054      {<span class="stringliteral">"1RXS"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"PosErr"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},
00055      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// original format of RA/DEC</span>
00056      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// is in sexagesimal</span>
00057      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// ==&gt; need to be added in decimal</span>
00058      {<span class="stringliteral">"1WGA"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"ErrorRad"</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00059      {<span class="stringliteral">"1RXS"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"PosErr"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},
00060      {<span class="stringliteral">"SNR"</span>,  <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>}   <span class="comment">// RA/DEC is in sexagesimal</span>
00061 };
00062 
00063 
00064 <span class="comment">/**********************************************************************/</span>
00065 <span class="comment">// erase m_strings, m_numericals but keep catalog definition</span>
<a name="l00066"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a20">00066</a> <span class="keywordtype">void</span> Catalog::deleteContent() {
00067 
00068   <span class="keywordtype">int</span> vecSize, i;
00069   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=0;
00070   <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>=0;
00071   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.size();
00072   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00073     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[i].clear();
00074     <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.clear();
00075   }
00076   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.size();
00077   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00078     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[i].clear();
00079     <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.clear();
00080   }
00081   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.size();
00082   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00083     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[i].clear();
00084     <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.clear();
00085   }
00086 }
00087 <span class="comment">/**********************************************************************/</span>
00088 <span class="comment">// erase catalog definition (private method)</span>
<a name="l00089"></a><a class="code" href="classcatalog_access_1_1_catalog.html#c0">00089</a> <span class="keywordtype">void</span> Catalog::deleteDescription() {
00090 
00091   <a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>=<span class="stringliteral">""</span>;
00092   <a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a> =<span class="stringliteral">""</span>;
00093   <a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>   =<span class="stringliteral">""</span>;
00094   <a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>    =<span class="stringliteral">""</span>;
00095   <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> =<span class="stringliteral">""</span>;
00096   <a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>  =<span class="stringliteral">""</span>;
00097   <span class="keywordflow">if</span> ( <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.is_open() ) <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.close();
00098   <a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>   =0;
00099   <a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a> = -1.0;
00100   <a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>=1.0;  <span class="comment">// "deg" by default</span>
00101   <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.clear();
00102   <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.clear();
00103 
00104   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>   =<a class="code" href="namespacecatalog_access.html#a34a13">IMPORT_NEED</a>;
00105   <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>=0;
00106   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numReadRows</a>=0;
00107   <a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_selection</a>=<span class="stringliteral">""</span>;
00108   <a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selRegion</a>=<span class="keyword">false</span>;
00109   <a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.clear();
00110   <a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>= -1;
00111   <a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a> = -1;
00112   <a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>= -1;
00113 }
00114 <span class="comment">/**********************************************************************/</span>
00115 <span class="comment">// erase elements in m_quantities according to m_loadQuantity,</span>
00116 <span class="comment">// deleteContent() MUST be done before</span>
<a name="l00117"></a><a class="code" href="classcatalog_access_1_1_catalog.html#c1">00117</a> <span class="keywordtype">void</span> Catalog::deleteQuantities() {
00118 
00119   <span class="keywordtype">int</span> maxSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.size(),
00120       nbA=0, nbD=0;
00121   <span class="keywordflow">if</span> (maxSize != <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.size()) {
00122     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"deleteQuantities"</span>,
00123              <span class="stringliteral">"problem in code, this error should not occur"</span>);
00124     <span class="keywordflow">return</span>;
00125   }
00126   <span class="comment">/* these vectors can be set if import was succesful with 0 row */</span>
00127   <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.clear();
00128   <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.clear();
00129   <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.clear();
00130   std::vector&lt;Quantity&gt;::iterator quantIter;
00131   quantIter=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.begin();
00132   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;maxSize; i++) {
00133     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>[i]) {<span class="comment">/* change the index in 2D tables */</span>
00134       <span class="keywordflow">if</span> ((*quantIter).m_format[0] == <span class="charliteral">'A'</span>) (*quantIter).m_index=nbA++;
00135       <span class="keywordflow">else</span> (*quantIter).m_index=nbD++;
00136       quantIter++;
00137     }
00138     <span class="keywordflow">else</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.erase(quantIter);
00139   }<span class="comment">/* loop on quantities */</span>
00140   <span class="comment">/* now that index have changed, update the index shortcuts */</span>
00141   <span class="keywordflow">for</span> (nbA=0; nbA&lt;<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>; nbA++) {
00142     <span class="keywordflow">if</span> (Catalog::s_CatalogList[2*nbA+1] == <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>) <span class="keywordflow">break</span>;
00143   }
00144   <a class="code" href="classcatalog_access_1_1_catalog.html#c10">setGeneric</a>(nbA);
00145 }
00146 <span class="comment">/**********************************************************************/</span>
00147 <span class="comment">// Copy constructor needed to allocate arrays in copy</span>
<a name="l00148"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a2">00148</a> Catalog::Catalog(<span class="keyword">const</span> <a class="code" href="classcatalog_access_1_1_catalog.html">Catalog</a> &amp; myCat) {
00149 
00150 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00151 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG Catalog COPY constructor on: "</span>
00152             &lt;&lt; myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> &lt;&lt; std::endl;
00153 <span class="preprocessor">  #endif  </span>
00154 <span class="preprocessor"></span>  std::string errText;
00155   <span class="comment">// copying values</span>
00156   <a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>;
00157   <a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a>;
00158   <a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>;
00159   <a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>    =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>;
00160   <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>;
00161   <a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>;
00162   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>;
00163   <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>;
00164   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numReadRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numReadRows</a>;
00165 <span class="comment">//  if ( myCat.myFile.is_open() ) { DO NOT COMPILE</span>
00166   <span class="keywordflow">if</span> ( myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a> &gt; 0 ) {
00167     <span class="comment">// the file read is left opened, don't know how to get stream on same file</span>
00168     errText=<span class="stringliteral">"FILE isn't CLOSED (in this version), FORBIDS importSelected"</span>;
00169     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00170   }
00171   <a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>=0;
00172   <a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a>;
00173   <a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
00174   <a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_selection</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_selection</a>;
00175   <a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_criteriaORed</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_criteriaORed</a>;
00176   <span class="comment">// following three data members needed for efficient selection</span>
00177   <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>;
00178   <a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>;
00179   <a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>;
00180   <a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>;
00181 
00182   <span class="comment">// copying elliptical region definition</span>
00183   <a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selRegion</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selRegion</a>;
00184   <a class="code" href="classcatalog_access_1_1_catalog.html#o21">m_selEllipseCentRA_deg</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o21">m_selEllipseCentRA_deg</a>;
00185   <a class="code" href="classcatalog_access_1_1_catalog.html#o22">m_selEllipseCentDEC_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o22">m_selEllipseCentDEC_deg</a>;
00186   <a class="code" href="classcatalog_access_1_1_catalog.html#o23">m_selEllipseMinAxis_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o23">m_selEllipseMinAxis_deg</a>;
00187   <a class="code" href="classcatalog_access_1_1_catalog.html#o24">m_selEllipseMajAxis_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o24">m_selEllipseMajAxis_deg</a>;
00188   <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_selEllipseRot_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_selEllipseRot_deg</a>;
00189 
00190   <span class="comment">// copying vectors</span>
00191 <span class="comment">//try {</span>
00192   <span class="keywordtype">long</span> i;
00193   <span class="keywordtype">int</span> vecSize, j;
00194   <span class="comment">// following data member m_selEllipse[] needed for efficient selection</span>
00195   <span class="keywordflow">try</span> {
00196     vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.size(); <span class="comment">// size is only 7</span>
00197     <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) <a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.at(j));
00198   }
00199   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00200     errText=std::string(<span class="stringliteral">"EXCEPTION on m_selEllipse[]: "</span>)+err.what();
00201     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00202     <span class="keywordflow">throw</span>;
00203   }
00204   <span class="comment">// following data member m_loadQuantity[] needed for importSelected()</span>
00205   <span class="keywordflow">try</span> {
00206     vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.size();
00207     <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.reserve(vecSize);  <span class="comment">// pre-allocate the memory </span>
00208     <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++)
00209       <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.at(j));
00210   }
00211   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00212     errText=std::string(<span class="stringliteral">"EXCEPTION on m_loadQuantity[]: "</span>)+err.what();
00213     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00214     <span class="keywordflow">throw</span>;
00215   }
00216   <span class="keywordflow">try</span> {
00217     std::vector&lt;Quantity&gt;::const_iterator itQ;
00218     <span class="keywordflow">for</span> (itQ=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.begin(); itQ!=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.end(); itQ++)
00219       <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.push_back(*itQ);
00220   }
00221   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00222     errText=std::string(<span class="stringliteral">"EXCEPTION on m_quantities[]: "</span>)+err.what();
00223     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00224     <span class="keywordflow">throw</span>;
00225   }
00226   <span class="comment">// suppose that each column has same number of rows</span>
00227   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.size();
00228   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00229     <span class="keywordflow">try</span> {
00230       <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.resize(vecSize);
00231       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00232         <span class="comment">// pre-allocate the memory for each vector</span>
00233         <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>);
00234         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++)
00235           <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[j].at(i));
00236       }
00237     }
00238     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00239       errText=std::string(<span class="stringliteral">"EXCEPTION on m_rowIsSelected[][]: "</span>)+err.what();
00240       <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00241       <span class="keywordflow">throw</span>;
00242     }
00243   }
00244   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.size();
00245   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00246     <span class="keywordflow">try</span> {
00247       <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.resize(vecSize);
00248       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00249         <span class="comment">// pre-allocate the memory for each vector</span>
00250         <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>);
00251         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++)
00252           <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].at(i));
00253       }
00254     }
00255     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00256       errText=std::string(<span class="stringliteral">"EXCEPTION on m_strings[][]: "</span>)+err.what();
00257       <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00258       <span class="keywordflow">throw</span>;
00259     }
00260   }
00261   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.size();
00262   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00263     <span class="keywordflow">try</span> {
00264       <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.resize(vecSize);
00265       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00266         <span class="comment">// pre-allocate the memory for each vector</span>
00267         <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>);
00268         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++)
00269           <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].at(i));
00270       }
00271     }
00272     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00273       errText=std::string(<span class="stringliteral">"EXCEPTION on m_numericals[][]: "</span>)+err.what();
00274       <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00275       <span class="keywordflow">throw</span>;
00276     }
00277   }
00278 <span class="comment">/* line is commented on purpose to TEMINATE the program on EXCEPTION */</span>
00279 <span class="comment">//} catch (...) { printErr("Catalog copy constructor", ""); }</span>
00280 }
00281 
00282 
00283 <span class="comment">/**********************************************************************/</span>
00284 <span class="comment">/*  METHODS giving GENERAL INFORMATION                                */</span>
00285 <span class="comment">/**********************************************************************/</span>
00286 <span class="comment">// return a list of all supported catalog names</span>
<a name="l00287"></a><a class="code" href="classcatalog_access_1_1_catalog.html#d0">00287</a> <span class="keywordtype">void</span> Catalog::getCatList(std::vector&lt;std::string&gt; *names, <span class="keyword">const</span> <span class="keywordtype">bool</span> isCode) {
00288 
00289   names-&gt;clear();
00290 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00291 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG number of known catalogs: "</span> &lt;&lt; <a class="code" href="catalog_8h.html#a0">MAX_CAT</a>
00292             &lt;&lt; std::endl;
00293 <span class="preprocessor">  #endif</span>
00294 <span class="preprocessor"></span>  std::string text;
00295   <span class="keywordtype">int</span> j=1;
00296   <span class="keywordflow">if</span> (isCode) j=0;
00297   <span class="keywordflow">try</span> {
00298     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>; i++) {
00299       text=Catalog::s_CatalogList[2*i+j]; <span class="comment">/* convert C string to C++ string */</span>
00300       names-&gt;push_back(text);
00301     }
00302   }
00303   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;prob) {
00304     text=std::string(<span class="stringliteral">"EXCEPTION filling names: "</span>)+prob.what();
00305     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"getCatList"</span>, text);
00306     <span class="keywordflow">throw</span>;
00307   }
00308 }
00309 <span class="comment">/**********************************************************************/</span>
00310 <span class="comment">// return a list of all supported web site names</span>
<a name="l00311"></a><a class="code" href="classcatalog_access_1_1_catalog.html#d1">00311</a> <span class="keywordtype">void</span> Catalog::getWebList(std::vector&lt;std::string&gt; *names, <span class="keyword">const</span> <span class="keywordtype">bool</span> isCode) {
00312 
00313   names-&gt;clear();
00314 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00315 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG number of web sites: "</span> &lt;&lt; <a class="code" href="catalog_8h.html#a2">MAX_URL</a>
00316             &lt;&lt; std::endl;
00317 <span class="preprocessor">  #endif</span>
00318 <span class="preprocessor"></span>  std::string text;
00319   <span class="keywordflow">try</span> {
00320     std::string s;
00321     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos;
00322     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="catalog_8h.html#a2">MAX_URL</a>; i++) {
00323       s=Catalog::s_CatalogURL[i]; <span class="comment">/* convert C string to C++ string */</span>
00324       <span class="keywordflow">if</span> (isCode) {
00325         pos=s.find(<span class="charliteral">' '</span>);
00326         <span class="keywordflow">if</span> (pos == std::string::npos) text=<span class="stringliteral">""</span>;
00327         <span class="keywordflow">else</span> text=s.substr(0, pos);
00328       }
00329       <span class="keywordflow">else</span> {
00330         pos=s.rfind(<span class="charliteral">' '</span>);
00331         <span class="keywordflow">if</span> (pos == std::string::npos) text=s;
00332         <span class="keywordflow">else</span> text=s.substr(pos+1, s.length()-pos);
00333       }
00334       names-&gt;push_back(text);
00335     }
00336   }
00337   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;prob) {
00338     text=std::string(<span class="stringliteral">"EXCEPTION filling names: "</span>)+prob.what();
00339     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(<span class="stringliteral">"getWebList"</span>, text);
00340     <span class="keywordflow">throw</span>;
00341   }
00342 }
00343 
00344 <span class="comment">/**********************************************************************/</span>
00345 <span class="comment">// to know the maximal number of rows in the file</span>
<a name="l00346"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a3">00346</a> <span class="keywordtype">int</span> Catalog::getMaxNumRows(<span class="keywordtype">long</span> *nrows, <span class="keyword">const</span> std::string &amp;fileName) {
00347 
00348   <span class="keywordtype">int</span> i, err;
00349   std::string text, origin=<span class="stringliteral">"getMaxNumRows"</span>;
00350   *nrows=0;
00351   err=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">false</span>);
00352   <span class="comment">// after this check, m_numReadRows is 0</span>
00353   <span class="keywordflow">if</span> (err &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> err;
00354 
00355   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=0;
00356   i=fileName.length();
00357   <span class="keywordflow">if</span> (i == 0) {
00358     text=<span class="stringliteral">": FILENAME is EMPTY"</span>;
00359     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00360     err=<a class="code" href="namespacecatalog_access.html#a34a15">BAD_FILENAME</a>;
00361     <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=err;
00362     <span class="keywordflow">return</span> err;
00363   }
00364   <span class="keywordflow">if</span> (fileName.at(i-1) == <span class="charliteral">']'</span>) {
00365     <span class="comment">// file should be a fits;</span>
00366  
00367     text=<span class="stringliteral">": fits FILE not handled now"</span>;
00368     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00369     err=<a class="code" href="namespacecatalog_access.html#a34a16">BAD_FILETYPE</a>;
00370     <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=err;
00371     <span class="keywordflow">return</span> err;
00372   }
00373   <span class="keywordflow">else</span> {
00374 
00375     std::ostringstream sortie;
00376     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tot=0ul; <span class="comment">// number of lines read</span>
00377     <span class="keywordtype">bool</span> testCR=<span class="keyword">false</span>; <span class="comment">// true if lines ends with CR (on windows)</span>
00378     <span class="keywordtype">int</span> what=0;        <span class="comment">// 0 for unkwown, &gt;0 for csv, &lt;0 to tsv</span>
00379                        <span class="comment">// fabs()=1 for standard, =2 for meta QUERY</span>
00380 
00381     <span class="keywordflow">if</span> ( <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.is_open() ) <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.close();
00382     <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.open(fileName.c_str(), std::ios::in);
00383     <span class="comment">// file can be opened ?</span>
00384     <span class="keywordflow">if</span> ( !<a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.is_open() ) {
00385       text=<span class="stringliteral">": FILENAME \""</span>+fileName+<span class="stringliteral">"\" cannot be opened"</span>;
00386       <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00387       err=<a class="code" href="namespacecatalog_access.html#a34a15">BAD_FILENAME</a>;
00388       <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=err;
00389       <span class="keywordflow">return</span> err;
00390     }
00391 <span class="comment">/*    DIR *testDir=opendir(fileName.c_str());</span>
00392 <span class="comment">    if (testDir != NULL) {</span>
00393 <span class="comment">      closedir(testDir);</span>
00394 <span class="comment">      myFile.close();</span>
00395 <span class="comment">      text=": FILENAME \""+fileName+"\" is a directory";</span>
00396 <span class="comment">      printErr(origin, text);</span>
00397 <span class="comment">      err=BAD_FILETYPE;</span>
00398 <span class="comment">      m_numRows=err;</span>
00399 <span class="comment">      return err;</span>
00400 <span class="comment">    }*/</span>
00401     err=<a class="code" href="classcatalog_access_1_1_catalog.html#c15">analyze_head</a>(&amp;tot, &amp;what, &amp;testCR);
00402     <span class="keywordflow">if</span> (!tot) {
00403       text=<span class="stringliteral">": FILENAME \""</span>+fileName+<span class="stringliteral">"\" is fits without extension[] specified"</span>;
00404       <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00405       <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>) err=<a class="code" href="namespacecatalog_access.html#a34a15">BAD_FILENAME</a>;
00406       <span class="comment">// in case, for strange reason, file.good() fails at first time</span>
00407     }
00408     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err &lt; <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>) {
00409       sortie &lt;&lt; <span class="stringliteral">": FILENAME \""</span> &lt;&lt; fileName &lt;&lt; <span class="stringliteral">"\" is empty or "</span>
00410              &lt;&lt; <span class="stringliteral">"has unknown structure (stopped step "</span> &lt;&lt; -1*err &lt;&lt; <span class="stringliteral">")"</span>;
00411       <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, sortie.str());
00412       sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00413       <span class="keywordflow">if</span> (err == 0) err=<a class="code" href="namespacecatalog_access.html#a34a15">BAD_FILENAME</a>; <span class="comment">/* nothing is read */</span>
00414       <span class="keywordflow">else</span> err=<a class="code" href="namespacecatalog_access.html#a34a16">BAD_FILETYPE</a>; <span class="comment">/* can search if catalog name exist */</span>
00415     }
00416     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (what == 2) {
00417       sortie &lt;&lt; <span class="stringliteral">"closing input META file ("</span> &lt;&lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>;
00418       sortie &lt;&lt; <span class="stringliteral">" rows in whole CDS catalog)"</span>;
00419       <a class="code" href="namespacecatalog_access.html#a33">printLog</a>(0, sortie.str());
00420     }
00421     <span class="keywordflow">else</span> {
00422       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> refRow=0ul;
00423       <span class="comment">// get columns description and units, data</span>
00424       err=<a class="code" href="classcatalog_access_1_1_catalog.html#c16">analyze_body</a>(&amp;tot, &amp;what, testCR, <span class="keyword">true</span>);
00425       <span class="comment">// only possible error: found &lt; 4</span>
00426       <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>) {
00427         <span class="comment">// decription is read until separation line starting with ---</span>
00428         <span class="keywordtype">char</span> line[<a class="code" href="catalog_8h.html#a3">MAX_LINE</a>];
00429         <span class="keywordtype">int</span>  posC,
00430              maxLine=<a class="code" href="catalog_8h.html#a3">MAX_LINE</a>-1; <span class="comment">// to avoid computation each line</span>
00431         refRow=tot+1;
00432         <span class="keywordflow">while</span> ( <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.good() ) {
00433           <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.getline(line, <a class="code" href="catalog_8h.html#a3">MAX_LINE</a>);
00434           tot++;
00435           i=strlen(line);
00436           <span class="keywordflow">if</span> (i &lt; 2) <span class="keywordflow">break</span>; <span class="comment">// in any case, stop on empty string contrary to</span>
00437                             <span class="comment">//  load() which continues, skipping lines</span>
00438           <span class="comment">// string max size is MAX_LINE-1;</span>
00439           <span class="keywordflow">if</span> (i &gt;= maxLine) {
00440             sortie &lt;&lt; <span class="stringliteral">"line #"</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">" exceeds maximal size ("</span>
00441                    &lt;&lt; <a class="code" href="catalog_8h.html#a3">MAX_LINE</a> &lt;&lt; <span class="stringliteral">")"</span>;
00442             <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, sortie.str());
00443             sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00444             err=<a class="code" href="namespacecatalog_access.html#a34a18">BAD_FILELINE</a>;
00445             <span class="keywordflow">break</span>;
00446           }
00447           <span class="comment">//if (testCR) line[--i]='\0';</span>
00448           posC=strncmp(line, <span class="stringliteral">"#Table"</span>, 6);
00449           <span class="keywordflow">if</span> (posC == 0) {
00450             <span class="comment">// should not happen, normally preceded by empty lines</span>
00451             sortie &lt;&lt; <span class="stringliteral">"line #"</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">": second table start (not read)"</span>;
00452             <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, sortie.str());
00453             sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00454             err=<a class="code" href="namespacecatalog_access.html#a34a21">BAD_ROW</a>;
00455             <span class="keywordflow">break</span>;
00456           }
00457         }
00458         <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a34a21">BAD_ROW</a>) err=<a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00459       }<span class="comment">// analyze_body() is OK</span>
00460  
00461       <span class="keywordflow">if</span> ((err &lt; IS_OK) &amp;&amp; (err &gt;= -3)) {
00462         sortie &lt;&lt; <span class="stringliteral">": FILENAME \""</span> &lt;&lt; fileName
00463             &lt;&lt; <span class="stringliteral">"\" has unknown type (stopped step "</span> &lt;&lt; 5-1*err &lt;&lt; <span class="stringliteral">")"</span>;
00464         <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, sortie.str());
00465         sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00466         err=<a class="code" href="namespacecatalog_access.html#a34a16">BAD_FILETYPE</a>;
00467       }
00468       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>) *nrows=tot-refRow;
00469       sortie &lt;&lt; <span class="stringliteral">"closing input text file: "</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">" lines read"</span>;
00470       <a class="code" href="namespacecatalog_access.html#a33">printLog</a>(0, sortie.str());
00471     }<span class="comment">// analyze_head() is OK</span>
00472 
00473   }<span class="comment">// file is read</span>
00474 
00475   <a class="code" href="classcatalog_access_1_1_catalog.html#c0">deleteDescription</a>(); <span class="comment">// close input file if left opened</span>
00476   <span class="keywordflow">return</span> err;
00477 }
00478 <span class="comment">/**********************************************************************/</span>
00479 <span class="comment">// to know the maximal number of rows in the CDS catalog</span>
<a name="l00480"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a4">00480</a> <span class="keywordtype">int</span> Catalog::getMaxNumRowsWeb(<span class="keywordtype">long</span> *nrows, <span class="keyword">const</span> std::string catName,
00481                               <span class="keyword">const</span> std::string urlCode) {
00482 
00483   <span class="keywordtype">int</span> i, err;
00484   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos;
00485   std::string web, text, origin=<span class="stringliteral">"getMaxNumRowsWeb"</span>;
00486   *nrows=0;
00487   err=<a class="code" href="namespacecatalog_access.html#a34a19">BAD_URL</a>;
00488   <span class="keywordflow">if</span> (urlCode.length() == 0) {
00489     text=<span class="stringliteral">": CODE for URL (web http address) is empty"</span>;
00490     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00491     <span class="keywordflow">return</span> err;
00492   }
00493   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="catalog_8h.html#a2">MAX_URL</a>; i++) {
00494     text=Catalog::s_CatalogURL[i]; <span class="comment">/* convert C string to C++ string */</span>
00495     pos=text.find(<span class="charliteral">' '</span>);
00496     <span class="keywordflow">if</span> (pos == std::string::npos) <span class="keywordflow">continue</span>;
00497     <span class="keywordflow">if</span> (text.substr(0, pos) == urlCode) <span class="keywordflow">break</span>;
00498   }
00499   <span class="keywordflow">if</span> (i == <a class="code" href="catalog_8h.html#a2">MAX_URL</a>) {
00500     text=<span class="stringliteral">": CODE for URL (web http address) do not exist"</span>;
00501     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00502     <span class="keywordflow">return</span> err;
00503   }
00504   pos=text.rfind(<span class="charliteral">' '</span>);
00505   <span class="keywordflow">if</span> (pos == std::string::npos) web=text;
00506   <span class="keywordflow">else</span> web=text.substr(pos+1, text.length()-pos);
00507 
00508   <span class="keywordtype">int</span> iCat=<a class="code" href="classcatalog_access_1_1_catalog.html#c21">checkCatName</a>(origin, catName);
00509   <span class="keywordflow">if</span> (iCat &lt; 0) <span class="keywordflow">return</span> iCat;
00510 
00511 <span class="comment">/* IS IT REALLY NEEDED ?</span>
00512 <span class="comment">  err=checkImport(origin, false);</span>
00513 <span class="comment">  if (err &lt; IS_VOID) return err;</span>
00514 <span class="comment">*/</span>
00515 <span class="comment">/* now, ASCII query must be created</span>
00516 <span class="comment">  and sent, using CDS package to given URL</span>
00517 <span class="comment">*/</span>
00518   err=-9;
00519   text=<span class="stringliteral">"Web query not implemented"</span>;
00520   <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00521 
00522   <span class="keywordflow">return</span> err;
00523 }
00524 
00525 
00526 <span class="comment">/**********************************************************************/</span>
00527 <span class="comment">/*  ACCESSING Catalog DEFINITION                                      */</span>
00528 <span class="comment">/**********************************************************************/</span>
00529 <span class="comment">// get the 3 definition strings</span>
<a name="l00530"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a12">00530</a> <span class="keywordtype">void</span> Catalog::getCatalogTitles(std::vector&lt;std::string&gt; *titles) {
00531 
00532   <span class="keywordtype">int</span> nb=titles-&gt;size();
00533   <span class="keywordflow">if</span> (nb == 0) titles-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>);
00534   <span class="keywordflow">else</span> (*titles)[0]=<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>;
00535   <span class="keywordflow">if</span> (nb &gt; 1) (*titles)[1]=<a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a>;       <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00536   <span class="keywordflow">if</span> (nb &gt; 2) (*titles)[2]=<a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>;   <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00537   <span class="keywordflow">if</span> (nb &gt; 3) (*titles)[3]=<a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>;    <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00538   <span class="keywordflow">if</span> (nb &gt; 4) (*titles)[4]=<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>; <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00539   <span class="keywordflow">if</span> (nb &gt; 5) (*titles)[5]=<a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00540 }
00541 
00542 <span class="comment">/**********************************************************************/</span>
00543 <span class="comment">// get an iterator on the quantities</span>
00544 
00545 
00546 <span class="comment">/**********************************************************************/</span>
00547 <span class="comment">// get a copy of the quantity vector</span>
<a name="l00548"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a13">00548</a> <span class="keywordtype">int</span> Catalog::getQuantityDescription(std::vector&lt;Quantity&gt; *myQuantities) {
00549 
00550   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(<span class="stringliteral">"getQuantityDescription"</span>, <span class="keyword">true</span>);
00551   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) {
00552     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getQuantityDescription"</span>, <span class="stringliteral">"returning unchanged vector."</span>);
00553     <span class="keywordflow">return</span> quantSize;
00554   }
00555   *myQuantities=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>;
00556   <span class="keywordflow">return</span> quantSize;
00557 }
00558 
00559 <span class="comment">/**********************************************************************/</span>
00560 <span class="comment">// get only Quantity member name</span>
<a name="l00561"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a14">00561</a> <span class="keywordtype">int</span> Catalog::getQuantityNames(std::vector&lt;std::string&gt; *names) {
00562 
00563   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityNames"</span>;
00564   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
00565   names-&gt;clear();
00566   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) {
00567     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00568     <span class="keywordflow">return</span> quantSize;
00569   }
00570   <span class="keywordflow">try</span> {
00571     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00572       names-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_name);
00573   }
00574   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00575     std::string errText;
00576     errText=std::string(<span class="stringliteral">"EXCEPTION on names: "</span>)+err.what();
00577     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, errText);
00578     <span class="keywordflow">throw</span>;
00579   }
00580   <span class="keywordflow">return</span> quantSize;
00581 }
00582 <span class="comment">/**********************************************************************/</span>
00583 <span class="comment">// get only Quantity member unit</span>
<a name="l00584"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a15">00584</a> <span class="keywordtype">int</span> Catalog::getQuantityUnits(std::vector&lt;std::string&gt; *units) {
00585 
00586   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityUnits"</span>;
00587   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
00588   units-&gt;clear();
00589   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) {
00590     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00591     <span class="keywordflow">return</span> quantSize;
00592   } 
00593   <span class="keywordflow">try</span> {
00594     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00595       units-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_unit);
00596   }
00597   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00598     std::string errText;
00599     errText=std::string(<span class="stringliteral">"EXCEPTION on units: "</span>)+err.what();
00600     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, errText);
00601     <span class="keywordflow">throw</span>;
00602   }
00603   <span class="keywordflow">return</span> quantSize;
00604 }
00605 <span class="comment">/**********************************************************************/</span>
00606 <span class="comment">// get only Quantity member ucd</span>
<a name="l00607"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a16">00607</a> <span class="keywordtype">int</span> Catalog::getQuantityUCDs (std::vector&lt;std::string&gt; *ucds) {
00608 
00609   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityUCDs"</span>;
00610   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
00611   ucds-&gt;clear();
00612   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) {
00613     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00614     <span class="keywordflow">return</span> quantSize;
00615   } 
00616   <span class="keywordflow">try</span> {
00617     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00618       ucds-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_ucd);
00619   }
00620   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00621     std::string errText;
00622     errText=std::string(<span class="stringliteral">"EXCEPTION on ucds: "</span>)+err.what();
00623     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, errText);
00624     <span class="keywordflow">throw</span>;
00625   }
00626   <span class="keywordflow">return</span> quantSize;
00627 }
00628 <span class="comment">/**********************************************************************/</span>
00629 <span class="comment">// get only Quantity member type</span>
<a name="l00630"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a17">00630</a> <span class="keywordtype">int</span> Catalog::getQuantityTypes(std::vector&lt;Quantity::QuantityType&gt; *types) {
00631 
00632   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityTypes"</span>;
00633   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
00634   types-&gt;clear();
00635   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) {
00636     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00637     <span class="keywordflow">return</span> quantSize;
00638   } 
00639   <span class="keywordflow">try</span> {
00640     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00641       types-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_type);
00642   }
00643   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00644     std::string errText;
00645     errText=std::string(<span class="stringliteral">"EXCEPTION on types: "</span>)+err.what();
00646     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, errText);
00647     <span class="keywordflow">throw</span>;
00648   }
00649   <span class="keywordflow">return</span> quantSize;
00650 }
00651 
00652 <span class="comment">/**********************************************************************/</span>
00653 <span class="comment">// get the member "statErrName" of given quantity "name"</span>
<a name="l00654"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a18">00654</a> <span class="keywordtype">int</span> Catalog::getStatErrorName(<span class="keyword">const</span> std::string name,
00655                               std::string *statErrName) {
00656 
00657   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(<span class="stringliteral">"getStatErrorName"</span>, <span class="keyword">true</span>);
00658   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> quantSize;
00659   quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(<span class="stringliteral">"getStatErrorName"</span>, name);
00660   <span class="keywordflow">if</span> (quantSize &lt; 0) <span class="keywordflow">return</span> quantSize;
00661   *statErrName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(quantSize).m_statError;
00662   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00663 }
00664 <span class="comment">/**********************************************************************/</span>
00665 <span class="comment">// get the member "sysErrName" of given quantity "name"</span>
<a name="l00666"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a19">00666</a> <span class="keywordtype">int</span> Catalog::getSysErrorName(<span class="keyword">const</span> std::string name,
00667                              std::string *sysErrName) {
00668 
00669   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(<span class="stringliteral">"getSysErrorName"</span>, <span class="keyword">true</span>);
00670   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> quantSize;
00671   quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(<span class="stringliteral">"getSysErrorName"</span>, name);
00672   <span class="keywordflow">if</span> (quantSize &lt; 0) <span class="keywordflow">return</span> quantSize;
00673   *sysErrName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(quantSize).m_sysError;
00674   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00675 }
00676   
00677 <span class="comment">/**********************************************************************/</span>
00678 <span class="comment">// get the list of names of the quantities which form the given vector "name"</span>
00679 
00680 
00681 
00682 <span class="comment">/**********************************************************************/</span>
00683 <span class="comment">/*  ACCESSING ALL Catalog CONTENTS in MEMORY (IGNORING SELECTION)     */</span>
00684 <span class="comment">/**********************************************************************/</span>
00685 <span class="comment">// get the number of rows in the catalog</span>
<a name="l00686"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a21">00686</a> <span class="keywordtype">void</span> Catalog::getNumRows(<span class="keywordtype">long</span> *nrows) {
00687 
00688   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0) *nrows=0;
00689   <span class="keywordflow">else</span> *nrows=<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>;
00690 }
00691 
00692 <span class="comment">/**********************************************************************/</span>
00693 <span class="comment">// get the value of given string quantity in given row</span>
<a name="l00694"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a22">00694</a> <span class="keywordtype">int</span> Catalog::getSValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00695                        std::string *stringVal) {
00696 
00697   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSValue"</span>;
00698   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
00699   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00700   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00701   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00702   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00703     std::string errText;
00704     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00705     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00706     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00707   }
00708   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00709 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00710 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG STRING index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00711 <span class="preprocessor">  #endif</span>
00712 <span class="preprocessor"></span>  *stringVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(row);
00713   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00714 }
00715 <span class="comment">/**********************************************************************/</span>
00716 <span class="comment">// get the value of given numerical quantity in given row</span>
<a name="l00717"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a23">00717</a> <span class="keywordtype">int</span> Catalog::getNValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00718                        <span class="keywordtype">double</span> *realVal) {
00719 
00720   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNValue"</span>;
00721   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
00722   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00723   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00724   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00725   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {  
00726     std::string errText;
00727     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00728     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00729     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00730   }
00731   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00732 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00733 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00734 <span class="preprocessor">  #endif</span>
00735 <span class="preprocessor"></span>  *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00736   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00737 }
00738 
00739 <span class="comment">/**********************************************************************/</span>
00740 <span class="comment">// get the values of given vector quantity in given row</span>
00741 
00742 <span class="comment">/**********************************************************************/</span>
00743 <span class="comment">// get the value of the statistical error of given quantity in given row</span>
<a name="l00744"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a24">00744</a> <span class="keywordtype">int</span> Catalog::getStatError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00745                           <span class="keywordtype">double</span> *realValStat) {
00746 
00747   *realValStat = -1.0;
00748   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getStatError"</span>;
00749   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
00750   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00751   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00752   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00753   std::string statName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_statError;
00754   <span class="keywordflow">if</span> (statName.empty()) {;
00755     statName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no statistical error"</span>;
00756     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, statName);
00757     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a24">NO_QUANT_ERR</a>;
00758   }
00759   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, statName);
00760   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00761   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00762 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00763 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM STAT index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00764 <span class="preprocessor">  #endif</span>
00765 <span class="preprocessor"></span>  *realValStat=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00766   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00767 }
00768 <span class="comment">/**********************************************************************/</span>
00769 <span class="comment">// get the value of the systematic error of given quantity in given row</span>
<a name="l00770"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a25">00770</a>   <span class="keywordtype">int</span> Catalog::getSysError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00771                            <span class="keywordtype">double</span> *realValSys) {
00772 
00773   *realValSys = -1.0;
00774   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSysError"</span>;
00775   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
00776   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00777   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00778   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00779   std::string sysName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_sysError;
00780   <span class="keywordflow">if</span> (sysName.empty()) {
00781     sysName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no systematic error"</span>;
00782     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, sysName);
00783     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a24">NO_QUANT_ERR</a>;
00784   }
00785   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, sysName);
00786   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00787   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00788 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00789 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM SYS. index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00790 <span class="preprocessor">  #endif</span>
00791 <span class="preprocessor"></span>  *realValSys=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00792   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00793 }
00794 
00795 <span class="comment">/**********************************************************************/</span>
00796 <span class="comment">// get the values of the statistical error of given vector in given row</span>
00797 
00798 <span class="comment">/**********************************************************************/</span>
00799 <span class="comment">// get the values of the systematic error of given vector in given row</span>
00800 
00801 
00802 <span class="comment">/**********************************************************************/</span>
00803 <span class="comment">// for string quantity: the list of different values assumed</span>
<a name="l00804"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a26">00804</a> <span class="keywordtype">int</span> Catalog::getSValues(<span class="keyword">const</span> std::string name,
00805                         std::vector&lt;std::string&gt; *values) {
00806 
00807   values-&gt;clear();
00808   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSValues"</span>;
00809   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, 0);
00810   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00811   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00812   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00813   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00814     std::string errText;
00815     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00816     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00817     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00818   }
00819   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00820   std::string text;
00821   <span class="keywordflow">try</span> {
00822     values-&gt;assign(1, <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(0));
00823     <span class="keywordtype">long</span> i, j, max;
00824     <span class="keywordflow">for</span> (i=1; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) {
00825       text=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i);
00826       max=values-&gt;size();
00827       <span class="keywordflow">for</span> (j=0; j&lt;max; j++) <span class="keywordflow">if</span> (values-&gt;at(j) == text) <span class="keywordflow">break</span>;
00828       <span class="keywordflow">if</span> (j == max) values-&gt;push_back(text);
00829     }
00830   }
00831   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00832     text=std::string(<span class="stringliteral">"EXCEPTION on values: "</span>)+err.what();
00833     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
00834     <span class="keywordflow">throw</span>;
00835   }
00836   <span class="keywordflow">return</span> values-&gt;size();
00837 }
00838 
00839 <span class="comment">/**********************************************************************/</span>
00840 <span class="comment">// for numerical quantity: the minimum value in the catalog</span>
<a name="l00841"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a27">00841</a> <span class="keywordtype">int</span> Catalog::minVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
00842 
00843   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
00844   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"minVal"</span>;
00845   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, 0);
00846   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00847   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00848   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00849   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
00850     std::string errText;
00851     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00852     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00853     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00854   }
00855   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00856   <span class="keywordtype">long</span> i=0;
00857   <span class="keywordtype">double</span> r;
00858   <span class="keywordflow">do</span> { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00859 <span class="comment">/*  std::cout &lt;&lt; "NaN == NaN ? " &lt;&lt; (*realVal == m_numericals[num].at(0))</span>
00860 <span class="comment">            &lt;&lt; std::endl;*/</span>
00861   }
00862   <span class="keywordflow">while</span> ((isnan(*realVal)) &amp;&amp; (++i &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>));
00863   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) {
00864     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00865     <span class="keywordflow">if</span> (r &lt; *realVal) *realVal=r;
00866   }
00867   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00868 }
00869 <span class="comment">/**********************************************************************/</span>
00870 <span class="comment">// for numerical quantity: the maximum value in the catalog</span>
<a name="l00871"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a28">00871</a> <span class="keywordtype">int</span> Catalog::maxVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
00872 
00873   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
00874   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"maxVal"</span>;
00875   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, 0);
00876   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00877   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00878   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00879   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
00880     std::string errText;
00881     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00882     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00883     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00884   }
00885   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00886   <span class="keywordtype">long</span> i=0;
00887   <span class="keywordtype">double</span> r;
00888   <span class="keywordflow">do</span> { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); }
00889   <span class="keywordflow">while</span> ((isnan(*realVal)) &amp;&amp; (++i &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>));
00890   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) {
00891     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00892     <span class="keywordflow">if</span> (r &gt; *realVal) *realVal=r;
00893   }
00894   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00895 }
00896 
00897 
00898 <span class="comment">/**********************************************************************/</span>
00899 <span class="comment">/*  ACCESSING the Catalog CONTENTS with in-memory SELECTION CRITERIA  */</span>
00900 <span class="comment">/**********************************************************************/</span>
00901 <span class="comment">// get the number of selected rows in the catalog</span>
<a name="l00902"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a29">00902</a> <span class="keywordtype">void</span> Catalog::getNumSelRows(<span class="keywordtype">long</span> *nrows) {
00903 
00904  *nrows=<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>;
00905 }
00906 
00907 <span class="comment">/**********************************************************************/</span>
00908 <span class="comment">// get the value of given string quantity in given selected row</span>
<a name="l00909"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a30">00909</a> <span class="keywordtype">int</span> Catalog::getSelSValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00910                           std::string *stringVal) {
00911 
00912   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSValue"</span>;
00913   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, srow);
00914   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00915   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00916   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00917   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00918   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00919     std::string errText;
00920     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00921     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00922     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00923   }
00924   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00925   <span class="keywordtype">long</span> tot=0;
00926   <span class="comment">// first bit indicates global selection</span>
00927   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00928     <span class="keywordflow">if</span> (tot == srow) { *stringVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i); <span class="keywordflow">break</span>; }
00929     tot++;
00930     <span class="comment">//if (tot == m_numSelRows) break; should not happen</span>
00931   }
00932   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00933   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
00934 }
00935 <span class="comment">/**********************************************************************/</span>
00936 <span class="comment">// get the value of given numerical quantity in given selected row</span>
<a name="l00937"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a31">00937</a> <span class="keywordtype">int</span> Catalog::getSelNValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00938                           <span class="keywordtype">double</span> *realVal) {
00939 
00940   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelNValue"</span>;
00941   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, srow);
00942   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00943   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00944   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00945   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00946   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {  
00947     std::string errText;
00948     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00949     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
00950     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
00951   }
00952   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00953   <span class="keywordtype">long</span> tot=0;
00954   <span class="comment">// first bit indicates global selection</span>
00955   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00956     <span class="keywordflow">if</span> (tot == srow) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
00957     tot++;
00958     <span class="comment">//if (tot == m_numSelRows) break; should not happen</span>
00959   }
00960   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00961   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
00962 }
00963 
00964 <span class="comment">/**********************************************************************/</span>
00965 <span class="comment">// get the values of given vector quantity in given selected row</span>
00966 
00967 <span class="comment">/**********************************************************************/</span>
00968 <span class="comment">// get value of the statistical error of given quantity in given selected row</span>
<a name="l00969"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a32">00969</a> <span class="keywordtype">int</span> Catalog::getSelStatError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00970                              <span class="keywordtype">double</span> *realValStat) {
00971 
00972   *realValStat = -1.0;
00973   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelStatError"</span>;
00974   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, srow);
00975   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
00976   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00977   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
00978   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00979   std::string statName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_statError;
00980   <span class="keywordflow">if</span> (statName.empty()) {;
00981     statName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no statistical error"</span>;
00982     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, statName);
00983     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a24">NO_QUANT_ERR</a>;
00984   }
00985   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, statName);
00986   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00987   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00988 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00989 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM STAT index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00990 <span class="preprocessor">  #endif</span>
00991 <span class="preprocessor"></span>  <span class="keywordtype">long</span> tot=0;
00992   <span class="comment">// first bit indicates global selection</span>
00993   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00994     <span class="keywordflow">if</span> (tot == srow) { *realValStat=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
00995     tot++;
00996   }
00997   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
00998   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
00999 }
01000 <span class="comment">/**********************************************************************/</span>
01001 <span class="comment">// get value of the systematic error of given quantity in given selected row</span>
<a name="l01002"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a33">01002</a> <span class="keywordtype">int</span> Catalog::getSelSysError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
01003                              <span class="keywordtype">double</span> *realValSys) {
01004 
01005   *realValSys = -1.0;
01006   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSysError"</span>;
01007   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, srow);
01008   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01009   <span class="comment">// above test avoid searching for srow when no row is selected</span>
01010   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
01011   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01012   std::string sysName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_sysError;
01013   <span class="keywordflow">if</span> (sysName.empty()) {;
01014     sysName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no systematic error"</span>;
01015     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, sysName);
01016     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a24">NO_QUANT_ERR</a>;
01017   }
01018   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, sysName);
01019   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01020   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01021 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
01022 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM SYS. index = "</span> &lt;&lt; num &lt;&lt; std::endl;
01023 <span class="preprocessor">  #endif</span>
01024 <span class="preprocessor"></span>  <span class="keywordtype">long</span> tot=0;
01025   <span class="comment">// first bit indicates global selection</span>
01026   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01027     <span class="keywordflow">if</span> (tot == srow) { *realValSys=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
01028     tot++;
01029   }
01030   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01031   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
01032 }
01033 <span class="comment">/**********************************************************************/</span>
01034 <span class="comment">// get the values of the statistical error of given vector in given selected row</span>
01035 
01036 <span class="comment">/**********************************************************************/</span>
01037 <span class="comment">// get the values of the systematic error of given vector in given selected row</span>
01038 
01039 
01040 <span class="comment">/**********************************************************************/</span>
01041 <span class="comment">// for string quantity: the list of different selected values assumed</span>
<a name="l01042"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a34">01042</a> <span class="keywordtype">int</span> Catalog::getSelSValues(<span class="keyword">const</span> std::string name,
01043                            std::vector&lt;std::string&gt; *values) {
01044 
01045   values-&gt;clear();
01046   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSValues"</span>;
01047   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, 0);
01048   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01049   <span class="comment">// above test avoid searching when no row is selected</span>
01050   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
01051   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01052   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
01053     std::string errText;
01054     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
01055     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
01056     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
01057   }
01058   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01059   std::string text;
01060   <span class="keywordflow">try</span> {
01061     <span class="keywordtype">long</span> j, max=0, tot=0;
01062     <span class="comment">// first bit indicates global selection</span>
01063     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01064       text=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i);
01065       <span class="keywordflow">if</span> (max == 0) {values-&gt;assign(1, text); max++;}
01066       <span class="keywordflow">else</span> {
01067         <span class="keywordflow">for</span> (j=0; j&lt;max; j++) <span class="keywordflow">if</span> (values-&gt;at(j) == text) <span class="keywordflow">break</span>;
01068         <span class="keywordflow">if</span> (j == max) {values-&gt;push_back(text); max++;}
01069       }
01070       <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01071     }
01072   }
01073   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
01074     text=std::string(<span class="stringliteral">"EXCEPTION on values: "</span>)+err.what();
01075     <a class="code" href="namespacecatalog_access.html#a31">printErr</a>(origin, text);
01076     <span class="keywordflow">throw</span>;
01077   }
01078   <span class="keywordflow">return</span> values-&gt;size();
01079 }
01080 
01081 <span class="comment">/**********************************************************************/</span>
01082 <span class="comment">// for numerical quantity: the minimum value in the selected rows</span>
<a name="l01083"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a35">01083</a> <span class="keywordtype">int</span> Catalog::minSelVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
01084 
01085   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
01086   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"minSelVal"</span>;
01087   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, 0);
01088   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01089   <span class="comment">// above test avoid searching when no row is selected</span>
01090   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
01091   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01092   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
01093     std::string errText;
01094     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
01095     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
01096     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
01097   }
01098   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01099 
01100   <span class="keywordtype">long</span> i, tot=0;
01101   <span class="keywordtype">double</span> r;
01102   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01103     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01104     <span class="keywordflow">if</span> (!isnan(*realVal)) <span class="keywordflow">break</span>;
01105     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01106   }
01107   <span class="keywordflow">if</span> (tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01108   <span class="comment">// stop when selection contains only NaN</span>
01109   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01110     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01111     <span class="keywordflow">if</span> (r &lt; *realVal) *realVal=r;
01112     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01113   }
01114   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01115 }
01116 <span class="comment">/**********************************************************************/</span>
01117 <span class="comment">// for numerical quantity: the maximum value in the selected rows</span>
<a name="l01118"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a36">01118</a> <span class="keywordtype">int</span> Catalog::maxSelVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
01119 
01120   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
01121   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"maxSelVal"</span>;
01122   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, 0);
01123   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01124   <span class="comment">// above test avoid searching when no row is selected</span>
01125   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkQuant_name</a>(origin, name);
01126   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01127   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
01128     std::string errText;
01129     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
01130     <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, errText);
01131     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a23">BAD_QUANT_TYPE</a>;
01132   }
01133   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01134 
01135   <span class="keywordtype">long</span> i, tot=0;
01136   <span class="keywordtype">double</span> r;
01137   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01138     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01139     <span class="keywordflow">if</span> (!isnan(*realVal)) <span class="keywordflow">break</span>;
01140     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01141   }
01142   <span class="keywordflow">if</span> (tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01143   <span class="comment">// stop when selection contains only NaN</span>
01144   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01145     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01146     <span class="keywordflow">if</span> (r &gt; *realVal) *realVal=r;
01147     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01148   }
01149   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01150 }
01151 
01152 
01153 <span class="comment">/**********************************************************************/</span>
01154 <span class="comment">/*  ACCESSING the Catalog GENERIC CONTENTS                            */</span>
01155 <span class="comment">/**********************************************************************/</span>
01156 <span class="comment">// access to generic quantity for RA  (degrees)</span>
<a name="l01157"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a37">01157</a> <span class="keywordtype">int</span> Catalog::ra_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal, <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01158 
01159   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"ra_deg"</span>;
01160   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a> &lt; 0) {
01161     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01162       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01163     <span class="keywordflow">else</span>
01164       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"missing generic RA position quantity"</span>);
01165     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a20">NO_RA_DEC</a>;
01166   }
01167   <span class="keywordtype">int</span> num;
01168   <span class="keywordflow">if</span> (!inSelection) {
01169     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
01170     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01171     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>].m_index;
01172     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
01173   }
01174   <span class="keywordflow">else</span> {
01175     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, row);
01176     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01177     <span class="keywordtype">long</span> tot=0;
01178     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>].m_index;
01179     <span class="comment">// first bit indicates global selection</span>
01180     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01181       <span class="keywordflow">if</span> (tot == row) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k); <span class="keywordflow">break</span>; }
01182       tot++;
01183     }
01184     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
01185   }
01186   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01187 }
01188 <span class="comment">/**********************************************************************/</span>
01189 <span class="comment">// access to generic quantity for DEC (degrees)</span>
<a name="l01190"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a38">01190</a> <span class="keywordtype">int</span> Catalog::dec_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal, <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01191 
01192   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"dec_deg"</span>;
01193   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a> &lt; 0) {
01194     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01195       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01196     <span class="keywordflow">else</span>
01197       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"missing generic DEC position quantity"</span>);
01198     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a20">NO_RA_DEC</a>;
01199   }
01200   <span class="keywordtype">int</span> num;
01201   <span class="keywordflow">if</span> (!inSelection) {
01202     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
01203     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01204     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>].m_index;
01205     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
01206   }
01207   <span class="keywordflow">else</span> {
01208     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, row);
01209     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01210     <span class="keywordtype">long</span> tot=0;
01211     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>].m_index;
01212     <span class="comment">// first bit indicates global selection</span>
01213     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01214       <span class="keywordflow">if</span> (tot == row) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k); <span class="keywordflow">break</span>; }
01215       tot++;
01216     }
01217     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
01218   }
01219   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01220 }
01221 <span class="comment">/**********************************************************************/</span>
01222 <span class="comment">// access to generic quantity for position uncertainty (degrees)</span>
<a name="l01223"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a39">01223</a> <span class="keywordtype">int</span> Catalog::posError_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal,
01224                           <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01225 
01226   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"posError_deg"</span>;
01227   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a> &lt; 0) {
01228     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01229       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01230     <span class="keywordflow">else</span>
01231       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(origin, <span class="stringliteral">"missing generic position error quantity"</span>);
01232     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a22">BAD_QUANT_NAME</a>;
01233   }
01234   <span class="keywordtype">int</span> num;
01235   <span class="keywordflow">if</span> (!inSelection) {
01236     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkSize_row</a>(origin, row);
01237     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01238     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>].m_index;
01239     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row)/<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
01240   }
01241   <span class="keywordflow">else</span> {
01242     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSel_row</a>(origin, row);
01243     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> num;
01244     <span class="keywordtype">long</span> tot=0;
01245     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>].m_index;
01246     <span class="comment">// first bit indicates global selection</span>
01247     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01248       <span class="keywordflow">if</span> (tot == row) {
01249         *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k)/<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
01250         <span class="keywordflow">break</span>;
01251       }
01252       tot++;
01253     }
01254     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>; <span class="comment">// should not happen</span>
01255   }
01256   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a34a10">IS_OK</a>;
01257 }
01258 
01259 <span class="comment">/**********************************************************************/</span>
01260 <span class="comment">// 6 methods returning the name of generic quantities</span>
<a name="l01261"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a40">01261</a> std::string Catalog::getNameRA() {
01262   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a> &lt; 0) {
01263     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01264       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getNameRA"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01265     <span class="keywordflow">else</span>
01266       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getNameRA"</span>, <span class="stringliteral">"missing generic RA position quantity"</span>);
01267     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01268   }
01269   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>].m_name;
01270 }
<a name="l01271"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a41">01271</a> std::string Catalog::getNameDEC() {
01272   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a> &lt; 0) {
01273     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01274       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getNameDEC"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01275     <span class="keywordflow">else</span>
01276       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getNameDEC"</span>, <span class="stringliteral">"missing generic DEC position quantity"</span>);
01277     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01278   }
01279   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>].m_name;
01280 }
<a name="l01281"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a42">01281</a> std::string Catalog::getNamePosErr() {
01282   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>&lt; 0) {
01283     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01284       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getNamePosErr"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01285     <span class="keywordflow">else</span>
01286       <a class="code" href="namespacecatalog_access.html#a32">printWarn</a>(<span class="stringliteral">"getNamePosErr"</span>, <span class="stringliteral">"missing generic position error quantity"</span>);
01287     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01288   }
01289   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>].m_name;
01290 }
01291 
<a name="l01292"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a43">01292</a> std::string Catalog::getNameL() {
01293   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameL"</span>;
01294   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
01295   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01296   <span class="keywordtype">int</span> i;
01297   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01298     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01299         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_ucd == Catalog::s_genericL))
01300       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01301   }
01302   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01303 }
<a name="l01304"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a44">01304</a> std::string Catalog::getNameB() {
01305   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameB"</span>;
01306   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
01307   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01308   <span class="keywordtype">int</span> i;
01309   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01310     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01311         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_ucd == Catalog::s_genericB))
01312       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01313   }
01314   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01315 }
01316 
<a name="l01317"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a45">01317</a> std::string Catalog::getNameObjName() {
01318   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameObjName"</span>;
01319   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c20">checkImport</a>(origin, <span class="keyword">true</span>);
01320   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a34a11">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01321   <span class="keywordtype">int</span> i;
01322   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01323     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01324         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_type == Quantity::STRING))
01325       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01326   }
01327   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01328 }
01329 
01330 } <span class="comment">// namespace catalogAccess</span>
</pre></div><hr><address style="align: right;"><small>Generated on Fri Jun 10 14:51:22 2005 for catalogAccess by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
