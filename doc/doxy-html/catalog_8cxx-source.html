<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>catalog.cxx Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>catalog.cxx</h1><a href="catalog_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00014 <span class="preprocessor">#include "<a class="code" href="catalog_8h.html">catalog.h</a>"</span>
00015 
<a name="l00016"></a><a class="code" href="namespacecatalog_access.html">00016</a> <span class="keyword">namespace </span>catalogAccess {
00017   <span class="keyword">using</span> <span class="keyword">namespace </span>tip;
00018 <span class="comment">/**********************************************************************/</span>
00019 <span class="comment">/*  DEFINING CLASS CONSTANTS                                          */</span>
00020 <span class="comment">/**********************************************************************/</span>
00021 
00022 <span class="comment">// available mirror sites for VizieR (from CDS)</span>
<a name="l00023"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r0">00023</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogURL[<a class="code" href="catalog_8h.html#a2">MAX_URL</a>]={
00024       <span class="stringliteral">"cds   fr vizier.u-strasbg.fr/"</span>,    <span class="comment">//CDS - Strasbourg, France</span>
00025       <span class="stringliteral">"cfa   us vizier.cfa.harvard.edu/"</span>, <span class="comment">//CFA - Harvard, USA</span>
00026       <span class="stringliteral">"cadc  ca vizier.hia.nrc.ca/"</span>,      <span class="comment">//CADC - Canada</span>
00027       <span class="stringliteral">"adac  jp vizier.nao.ac.jp/"</span>,       <span class="comment">//ADAC - Tokyo, Japan</span>
00028       <span class="stringliteral">"ukirt hawaii www.ukirt.jach.hawaii.edu/"</span>, <span class="comment">//JAC - Hawaii, USA</span>
00029       <span class="stringliteral">"cambridge uk archive.ast.cam.ac.uk/"</span>,
00030       <span class="stringliteral">"iucaa in urania.iucaa.ernet.in/"</span>,  <span class="comment">//IUCAA - Pune, India</span>
00031       <span class="stringliteral">"moscow ru www.inasan.rssi.ru/"</span>,    <span class="comment">//INASAN - Russia (DOES IT WORK ?)</span>
00032       <span class="stringliteral">"bejing cn data.bao.ac.cn/"</span>         <span class="comment">//Bejing Obs. - China</span>
00033       };
00034 
00035 <span class="comment">// information on catalog size laste updated on: JAN 2005</span>
<a name="l00036"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r1">00036</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogList[2*<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>]={
00037       <span class="stringliteral">"EGRET3 sources"</span>, <span class="stringliteral">"J/ApJS/123/79/3eg"</span>,    <span class="comment">//   271 rows (20 columns)</span>
00038       <span class="stringliteral">"EGRET3 fluxes"</span>,  <span class="stringliteral">"J/ApJS/123/79/fluxes"</span>, <span class="comment">//  5245 rows (10 columns)</span>
00039       <span class="stringliteral">"EGRET3 periods"</span>, <span class="stringliteral">"J/ApJS/123/79/table1"</span>, <span class="comment">//   169 rows ( 6 columns)</span>
00040       <span class="stringliteral">"ROSAT 1RXS"</span>,     <span class="stringliteral">"IX/10A/1rxs"</span>,          <span class="comment">// 18806 rows (28 columns)</span>
00041       <span class="stringliteral">"Veron (11th) quasar"</span>, <span class="stringliteral">"VII/235/table1"</span>,  <span class="comment">// 48921 rows (21 columns)</span>
00042       <span class="stringliteral">"Veron (11th) BL Lac"</span>, <span class="stringliteral">"VII/235/table2"</span>,  <span class="comment">//   876 rows (21 columns)</span>
00043       <span class="stringliteral">"Veron (11th) AGN"</span>,    <span class="stringliteral">"VII/235/table3"</span>,  <span class="comment">// 15069 rows (21 columns)</span>
00044       <span class="stringliteral">"WGACAT of ROSAT"</span>,     <span class="stringliteral">"IX/31/wgacat"</span>,    <span class="comment">// 88621 rows (101 columns)</span>
00045       <span class="stringliteral">"ROSAT faint sources"</span>, <span class="stringliteral">"IX/29/rass_fsc"</span>,  <span class="comment">//105924 rows (30 columns)</span>
00046       <span class="stringliteral">"Green galactic SNR"</span>,  <span class="stringliteral">"VII/227/snrs"</span>     <span class="comment">//   231 rows (14 columns)</span>
00047       };
00048 
00049 
<a name="l00050"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r2">00050</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogGeneric[<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>][<a class="code" href="catalog_8h.html#a1">MAX_GEN</a>]={
00051      {<span class="stringliteral">"3EG"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"theta95"</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00052      {<span class="stringliteral">"3EG"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>},
00053      {<span class="stringliteral">""</span>,    <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00054      {<span class="stringliteral">"1RXS"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"PosErr"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},
00055      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// original format of RA/DEC</span>
00056      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// is in sexagesimal</span>
00057      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// ==&gt; need to be added in decimal</span>
00058      {<span class="stringliteral">"1WGA"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"ErrorRad"</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00059      {<span class="stringliteral">"1RXS"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"PosErr"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},
00060      {<span class="stringliteral">"SNR"</span>,  <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>}   <span class="comment">// RA/DEC is in sexagesimal</span>
00061 };
00062 
00063 
00064 <span class="comment">/**********************************************************************/</span>
00065 <span class="comment">// erase m_strings, m_numericals but keep catalog definition</span>
<a name="l00066"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a23">00066</a> <span class="keywordtype">void</span> Catalog::deleteContent() {
00067 
00068   <span class="keywordtype">int</span> vecSize, i;
00069   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=0;
00070   <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>=0;
00071   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>.size();
00072   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00073     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[i].clear();
00074     <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>.clear();
00075   }
00076   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.size();
00077   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00078     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[i].clear();
00079     <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.clear();
00080   }
00081   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.size();
00082   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00083     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[i].clear();
00084     <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.clear();
00085   }
00086 }
00087 <span class="comment">/**********************************************************************/</span>
00088 <span class="comment">// erase catalog definition (private method)</span>
<a name="l00089"></a><a class="code" href="classcatalog_access_1_1_catalog.html#c0">00089</a> <span class="keywordtype">void</span> Catalog::deleteDescription() {
00090 
00091   <a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>=<span class="stringliteral">""</span>;
00092   <a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a> =<span class="stringliteral">""</span>;
00093   <a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>   =<span class="stringliteral">""</span>;
00094   <a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>    =<span class="stringliteral">""</span>;
00095   <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> =<span class="stringliteral">""</span>;
00096   <a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>  =<span class="stringliteral">""</span>;
00097 
00098   <a class="code" href="classcatalog_access_1_1_catalog.html#o6">m_filename</a>  =<span class="stringliteral">""</span>;
00099   <a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>   =0;
00100   <a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a> = -1.0;
00101   <a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>=1.0;  <span class="comment">// "deg" by default</span>
00102   <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.clear();
00103   <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.clear();
00104 
00105   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>   =<a class="code" href="namespacecatalog_access.html#a31a10">IMPORT_NEED</a>;
00106   <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>=0;
00107   <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_selection</a>=<span class="stringliteral">""</span>;
00108   <a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_criteriaORed</a>=<span class="keyword">false</span>;
00109   <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>=0;
00110   <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>= -1;
00111   <a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a> = -1;
00112   <a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a>= -1;
00113   <a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_selRegion</a>=<span class="keyword">false</span>;
00114   <a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_selEllipse</a>.clear();
00115 }
00116 <span class="comment">/**********************************************************************/</span>
00117 <span class="comment">// erase elements in m_quantities according to m_loadQuantity,</span>
00118 <span class="comment">// deleteContent() MUST be done before</span>
<a name="l00119"></a><a class="code" href="classcatalog_access_1_1_catalog.html#c1">00119</a> <span class="keywordtype">void</span> Catalog::deleteQuantities() {
00120 
00121   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.size();
00122   <span class="keywordtype">int</span>  nbA=0, nbD=0;
00123 
00124   <span class="keywordflow">if</span> (maxSize != <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.size()) {
00125     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"deleteQuantities"</span>,
00126              <span class="stringliteral">"problem in code, this error should not occur"</span>);
00127     <span class="keywordflow">return</span>;
00128   }
00129   <span class="comment">/* these vectors can be set if import was succesful with 0 row */</span>
00130   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>.clear();
00131   <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.clear();
00132   <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.clear();
00133   std::vector&lt;Quantity&gt;::iterator quantIter;
00134   quantIter=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.begin();
00135   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;maxSize; i++) {
00136     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>[i]) {<span class="comment">/* change the index in 2D tables */</span>
00137       <span class="keywordflow">if</span> (quantIter-&gt;m_format[0] == <span class="charliteral">'A'</span>) quantIter-&gt;m_index=nbA++;
00138       <span class="keywordflow">else</span> quantIter-&gt;m_index=nbD++;
00139       quantIter++;
00140     }
00141     <span class="keywordflow">else</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.erase(quantIter);
00142   }<span class="comment">/* loop on quantities */</span>
00143   <span class="comment">/* now that index have changed, update the index shortcuts */</span>
00144   <span class="keywordflow">for</span> (nbA=0; nbA&lt;<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>; nbA++) {
00145     <span class="keywordflow">if</span> (Catalog::s_CatalogList[2*nbA+1] == <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>) <span class="keywordflow">break</span>;
00146   }
00147   <a class="code" href="classcatalog_access_1_1_catalog.html#c10">setGeneric</a>(nbA);
00148 }
00149 <span class="comment">/**********************************************************************/</span>
00150 <span class="comment">// Copy constructor needed to allocate arrays in copy</span>
<a name="l00151"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a2">00151</a> Catalog::Catalog(<span class="keyword">const</span> <a class="code" href="classcatalog_access_1_1_catalog.html">Catalog</a> &amp; myCat) {
00152 
00153 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00154 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG Catalog COPY constructor on: "</span>
00155             &lt;&lt; myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> &lt;&lt; std::endl;
00156 <span class="preprocessor">  #endif  </span>
00157 <span class="preprocessor"></span>  std::string errText;
00158   <span class="comment">// copying values</span>
00159   <a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>;
00160   <a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a>;
00161   <a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>;
00162   <a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>    =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>;
00163   <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>;
00164   <a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>;
00165 
00166   <a class="code" href="classcatalog_access_1_1_catalog.html#o6">m_filename</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o6">m_filename</a>;
00167   <a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>    =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>;
00168   <a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a>;
00169   <a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
00170 
00171   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>;
00172   <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>;
00173   <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_selection</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_selection</a>;
00174   <a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_criteriaORed</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_criteriaORed</a>;
00175   <span class="comment">// following three data members needed for efficient selection</span>
00176   <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>;
00177   <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>;
00178   <a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a>;
00179   <a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a>;
00180 
00181   <span class="comment">// copying elliptical region definition</span>
00182   <a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_selRegion</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_selRegion</a>;
00183   <a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selEllipseCentRA_deg</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selEllipseCentRA_deg</a>;
00184   <a class="code" href="classcatalog_access_1_1_catalog.html#o21">m_selEllipseCentDEC_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o21">m_selEllipseCentDEC_deg</a>;
00185   <a class="code" href="classcatalog_access_1_1_catalog.html#o22">m_selEllipseMinAxis_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o22">m_selEllipseMinAxis_deg</a>;
00186   <a class="code" href="classcatalog_access_1_1_catalog.html#o23">m_selEllipseMajAxis_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o23">m_selEllipseMajAxis_deg</a>;
00187   <a class="code" href="classcatalog_access_1_1_catalog.html#o24">m_selEllipseRot_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o24">m_selEllipseRot_deg</a>;
00188 
00189   <span class="comment">// copying vectors</span>
00190 <span class="comment">//try {</span>
00191   <span class="keywordtype">long</span> i;
00192   <span class="keywordtype">int</span> vecSize, j;
00193   <span class="comment">// following data member m_selEllipse[] needed for efficient selection</span>
00194   <span class="keywordflow">try</span> {
00195     vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_selEllipse</a>.size(); <span class="comment">// size is only 7</span>
00196     <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) <a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_selEllipse</a>.push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_selEllipse</a>.at(j));
00197   }
00198   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00199     errText=std::string(<span class="stringliteral">"EXCEPTION on m_selEllipse[]: "</span>)+err.what();
00200     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00201     <span class="keywordflow">throw</span>;
00202   }
00203   <span class="comment">// following data member m_loadQuantity[] needed for importSelected()</span>
00204   <span class="keywordflow">try</span> {
00205     vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.size();
00206     <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.reserve(vecSize);  <span class="comment">// pre-allocate the memory </span>
00207     <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++)
00208       <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.at(j));
00209   }
00210   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00211     errText=std::string(<span class="stringliteral">"EXCEPTION on m_loadQuantity[]: "</span>)+err.what();
00212     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00213     <span class="keywordflow">throw</span>;
00214   }
00215   <span class="keywordflow">try</span> {
00216     std::vector&lt;Quantity&gt;::const_iterator itQ;
00217     <span class="keywordflow">for</span> (itQ=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.begin(); itQ!=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.end(); itQ++)
00218       <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.push_back(*itQ);
00219   }
00220   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00221     errText=std::string(<span class="stringliteral">"EXCEPTION on m_quantities[]: "</span>)+err.what();
00222     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00223     <span class="keywordflow">throw</span>;
00224   }
00225   <span class="comment">// suppose that each column has same number of rows</span>
00226   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>.size();
00227   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00228     <span class="keywordflow">try</span> {
00229       <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>.resize(vecSize);
00230       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00231         <span class="comment">// pre-allocate the memory for each vector</span>
00232         <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>);
00233         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++)
00234           <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[j].at(i));
00235       }
00236     }
00237     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00238       errText=std::string(<span class="stringliteral">"EXCEPTION on m_rowIsSelected[][]: "</span>)+err.what();
00239       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00240       <span class="keywordflow">throw</span>;
00241     }
00242   }
00243   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.size();
00244   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00245     <span class="keywordflow">try</span> {
00246       <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.resize(vecSize);
00247       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00248         <span class="comment">// pre-allocate the memory for each vector</span>
00249         <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>);
00250         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++)
00251           <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].at(i));
00252       }
00253     }
00254     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00255       errText=std::string(<span class="stringliteral">"EXCEPTION on m_strings[][]: "</span>)+err.what();
00256       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00257       <span class="keywordflow">throw</span>;
00258     }
00259   }
00260   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.size();
00261   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00262     <span class="keywordflow">try</span> {
00263       <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.resize(vecSize);
00264       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00265         <span class="comment">// pre-allocate the memory for each vector</span>
00266         <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>);
00267         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++)
00268           <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].at(i));
00269       }
00270     }
00271     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00272       errText=std::string(<span class="stringliteral">"EXCEPTION on m_numericals[][]: "</span>)+err.what();
00273       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00274       <span class="keywordflow">throw</span>;
00275     }
00276   }
00277 <span class="comment">/* line is commented on purpose to TEMINATE the program on EXCEPTION */</span>
00278 <span class="comment">//} catch (...) { printErr("Catalog copy constructor", ""); }</span>
00279 }
00280 
00281 
00282 <span class="comment">/**********************************************************************/</span>
00283 <span class="comment">/*  METHODS giving GENERAL INFORMATION                                */</span>
00284 <span class="comment">/**********************************************************************/</span>
00285 <span class="comment">// return a list of all supported catalog names</span>
<a name="l00286"></a><a class="code" href="classcatalog_access_1_1_catalog.html#d0">00286</a> <span class="keywordtype">void</span> Catalog::getCatList(std::vector&lt;std::string&gt; *names, <span class="keyword">const</span> <span class="keywordtype">bool</span> isCode) {
00287 
00288   names-&gt;clear();
00289 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00290 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG number of known catalogs: "</span> &lt;&lt; <a class="code" href="catalog_8h.html#a0">MAX_CAT</a>
00291             &lt;&lt; std::endl;
00292 <span class="preprocessor">  #endif</span>
00293 <span class="preprocessor"></span>  std::string text;
00294   <span class="keywordtype">int</span> j=1;
00295   <span class="keywordflow">if</span> (isCode) j=0;
00296   <span class="keywordflow">try</span> {
00297     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>; i++) {
00298       text=Catalog::s_CatalogList[2*i+j]; <span class="comment">/* convert C string to C++ string */</span>
00299       names-&gt;push_back(text);
00300     }
00301   }
00302   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;prob) {
00303     text=std::string(<span class="stringliteral">"EXCEPTION filling names: "</span>)+prob.what();
00304     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"getCatList"</span>, text);
00305     <span class="keywordflow">throw</span>;
00306   }
00307 }
00308 <span class="comment">/**********************************************************************/</span>
00309 <span class="comment">// return a list of all supported web site names</span>
<a name="l00310"></a><a class="code" href="classcatalog_access_1_1_catalog.html#d1">00310</a> <span class="keywordtype">void</span> Catalog::getWebList(std::vector&lt;std::string&gt; *names, <span class="keyword">const</span> <span class="keywordtype">bool</span> isCode) {
00311 
00312   names-&gt;clear();
00313 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00314 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG number of web sites: "</span> &lt;&lt; <a class="code" href="catalog_8h.html#a2">MAX_URL</a>
00315             &lt;&lt; std::endl;
00316 <span class="preprocessor">  #endif</span>
00317 <span class="preprocessor"></span>  std::string text;
00318   <span class="keywordflow">try</span> {
00319     std::string s;
00320     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos;
00321     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="catalog_8h.html#a2">MAX_URL</a>; i++) {
00322       s=Catalog::s_CatalogURL[i]; <span class="comment">/* convert C string to C++ string */</span>
00323       <span class="keywordflow">if</span> (isCode) {
00324         pos=s.find(<span class="charliteral">' '</span>);
00325         <span class="keywordflow">if</span> (pos == std::string::npos) text=<span class="stringliteral">""</span>;
00326         <span class="keywordflow">else</span> text=s.substr(0, pos);
00327       }
00328       <span class="keywordflow">else</span> {
00329         pos=s.rfind(<span class="charliteral">' '</span>);
00330         <span class="keywordflow">if</span> (pos == std::string::npos) text=s;
00331         <span class="keywordflow">else</span> text=s.substr(pos+1, s.length()-pos);
00332       }
00333       names-&gt;push_back(text);
00334     }
00335   }
00336   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;prob) {
00337     text=std::string(<span class="stringliteral">"EXCEPTION filling names: "</span>)+prob.what();
00338     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(<span class="stringliteral">"getWebList"</span>, text);
00339     <span class="keywordflow">throw</span>;
00340   }
00341 }
00342 
00343 <span class="comment">/**********************************************************************/</span>
00344 <span class="comment">// to know the maximal number of rows in the file</span>
<a name="l00345"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a3">00345</a> <span class="keywordtype">int</span> Catalog::getMaxNumRows(<span class="keywordtype">long</span> *nrows, <span class="keyword">const</span> std::string &amp;fileName,
00346                            <span class="keyword">const</span> std::string ext) {
00347 
00348   <span class="keywordtype">int</span> i, err;
00349   std::string text, origin=<span class="stringliteral">"getMaxNumRows"</span>;
00350   *nrows=0;
00351   err=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">false</span>);
00352   <span class="keywordflow">if</span> (err &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> err;
00353 
00354   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=0;
00355   i=fileName.length();
00356   <span class="keywordflow">if</span> (i == 0) {
00357     text=<span class="stringliteral">": FILENAME is EMPTY"</span>;
00358     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00359     err=<a class="code" href="namespacecatalog_access.html#a31a12">BAD_FILENAME</a>;
00360     <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=err;
00361     <span class="keywordflow">return</span> err;
00362   }
00363   std::fstream myFile (fileName.c_str(), std::ios::in);
00364   <span class="comment">// file can be opened ?</span>
00365   <span class="keywordflow">if</span> ( !myFile.is_open() ) {
00366     text=<span class="stringliteral">": FILENAME \""</span>+fileName+<span class="stringliteral">"\" cannot be opened"</span>;
00367     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00368     err=<a class="code" href="namespacecatalog_access.html#a31a12">BAD_FILENAME</a>;
00369     <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=err;
00370     <span class="keywordflow">return</span> err;
00371   }
00372 <span class="comment">/*  DIR *testDir=opendir(fileName.c_str());</span>
00373 <span class="comment">  if (testDir != NULL) {</span>
00374 <span class="comment">    closedir(testDir);</span>
00375 <span class="comment">    text=": FILENAME \""+fileName+"\" is a directory";</span>
00376 <span class="comment">    printErr(origin, text);</span>
00377 <span class="comment">    err=BAD_FILETYPE;</span>
00378 <span class="comment">    m_numRows=err;</span>
00379 <span class="comment">    return err;</span>
00380 <span class="comment">  }*/</span>
00381   myFile.close();
00382   std::ostringstream sortie;
00383   <span class="keywordtype">bool</span>  myTest;
00384   <span class="keyword">const</span> Extension *myEXT = 0;
00385   <span class="comment">// cannot use readTable because FITS IMAGE returns also error 1</span>
00386   <span class="keywordflow">try</span> {
00387     myEXT=IFileSvc::instance().readExtension(fileName, ext);
00388   }
00389   <span class="keywordflow">catch</span> (<span class="keyword">const</span> TipException &amp;x) {
00390     err=x.code();
00391     <span class="keywordflow">if</span> (err == 1) {
00392       <span class="comment">// This non-cfitsio error number means the file does not exist</span>
00393       <span class="comment">// or is not a table, or is not in either Root nor Fits format. </span>
00394       err=<a class="code" href="namespacecatalog_access.html#a31a14">BAD_FITS</a>;
00395 <span class="comment">/*      printWarn(origin, "FILENAME is NOT fits");*/</span>
00396     }
00397     <span class="keywordflow">else</span> {
00398       <span class="comment">// Other errors come from cfitsio, but apply to a file</span>
00399       <span class="comment">// which is in FITS format but has some sort of format error.</span>
00400       sortie &lt;&lt; <span class="stringliteral">": FILENAME is FITS, but cfitsio returned error="</span> &lt;&lt; err;
00401       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, sortie.str());
00402       err=<a class="code" href="namespacecatalog_access.html#a31a14">BAD_FITS</a>;
00403       <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=err;
00404       <span class="keyword">delete</span> myEXT;
00405       <span class="keywordflow">return</span> err;
00406     }
00407   }
00408   <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>) myTest=myEXT-&gt;isTable();
00409   <span class="keyword">delete</span> myEXT;
00410   <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>) {
00411  
00412     <span class="keywordflow">if</span> (!myTest) {
00413       text=<span class="stringliteral">": FILENAME is FITS, but NOT a TABLE"</span>;
00414       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00415       err=<a class="code" href="namespacecatalog_access.html#a31a14">BAD_FITS</a>;
00416       <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=err;
00417       <span class="keywordflow">return</span> err;
00418     }
00419     <span class="keyword">const</span> Table *myDOL = 0;
00420     <span class="keywordflow">try</span> {
00421       myDOL=IFileSvc::instance().readTable(fileName, ext);
00422       *nrows=myDOL-&gt;getNumRecords();
00423     }
00424     <span class="keywordflow">catch</span> (<span class="keyword">const</span> TipException &amp;x) {
00425       sortie &lt;&lt; <span class="stringliteral">": FITS is TABLE, but cfitsio returned error="</span> &lt;&lt; err;
00426       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, sortie.str());
00427       err=<a class="code" href="namespacecatalog_access.html#a31a14">BAD_FITS</a>;
00428       <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>=err;
00429       <span class="keyword">delete</span> myDOL;
00430       <span class="keywordflow">return</span> err;
00431     }
00432     <span class="keyword">delete</span> myDOL;
00433 
00434   }
00435   <span class="keywordflow">else</span> { <span class="comment">// (err == BAD_FITS)</span>
00436 
00437     err=<a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00438     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tot=0ul; <span class="comment">// number of lines read</span>
00439     <span class="keywordtype">bool</span> testCR=<span class="keyword">false</span>; <span class="comment">// true if lines ends with CR (on windows)</span>
00440     <span class="keywordtype">int</span> what=0;        <span class="comment">// 0 for unkwown, &gt;0 for csv, &lt;0 to tsv</span>
00441                        <span class="comment">// fabs()=1 for standard, =2 for meta QUERY</span>
00442 
00443     myFile.open(fileName.c_str(), std::ios::in);
00444     err=<a class="code" href="classcatalog_access_1_1_catalog.html#c15">analyze_head</a>(&amp;tot, &amp;what, &amp;testCR, &amp;myFile);
00445     <span class="keywordflow">if</span> (!tot) {
00446       text=<span class="stringliteral">": FILENAME \""</span>+fileName+<span class="stringliteral">"\" is fits without extension[] specified"</span>;
00447       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00448       <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>) err=<a class="code" href="namespacecatalog_access.html#a31a12">BAD_FILENAME</a>;
00449       <span class="comment">// in case, for strange reason, file.good() fails at first time</span>
00450     }
00451     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err &lt; <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>) {
00452       sortie &lt;&lt; <span class="stringliteral">": FILENAME \""</span> &lt;&lt; fileName &lt;&lt; <span class="stringliteral">"\" is empty or "</span>
00453              &lt;&lt; <span class="stringliteral">"has unknown structure (stopped step "</span> &lt;&lt; -1*err &lt;&lt; <span class="stringliteral">")"</span>;
00454       <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, sortie.str());
00455       sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00456       <span class="keywordflow">if</span> (err == 0) err=<a class="code" href="namespacecatalog_access.html#a31a12">BAD_FILENAME</a>; <span class="comment">/* nothing is read */</span>
00457       <span class="keywordflow">else</span> err=<a class="code" href="namespacecatalog_access.html#a31a13">BAD_FILETYPE</a>; <span class="comment">/* can search if catalog name exist */</span>
00458     }
00459     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (what == 2) {
00460       sortie &lt;&lt; <span class="stringliteral">"closing input META file ("</span> &lt;&lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>;
00461       sortie &lt;&lt; <span class="stringliteral">" rows in whole CDS catalog)"</span>;
00462       <a class="code" href="namespacecatalog_access.html#a30">printLog</a>(0, sortie.str());
00463     }
00464     <span class="keywordflow">else</span> {
00465       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> refRow=0ul;
00466       <span class="keywordtype">long</span> maxRows=0l;
00467       <span class="comment">// get columns description and units, data</span>
00468       err=<a class="code" href="classcatalog_access_1_1_catalog.html#c16">analyze_body</a>(&amp;tot, &amp;what, testCR, <span class="keyword">true</span>, &amp;myFile, &amp;maxRows);
00469       <span class="comment">// only possible error: found &lt; 4</span>
00470       <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>) {
00471         <span class="comment">// decription is read until separation line starting with ---</span>
00472         <span class="keywordtype">char</span> line[<a class="code" href="catalog_8h.html#a3">MAX_LINE</a>];
00473         <span class="keywordtype">int</span>  posC,
00474              maxLine=<a class="code" href="catalog_8h.html#a3">MAX_LINE</a>-1; <span class="comment">// to avoid computation each line</span>
00475         refRow=tot+1;
00476         <span class="keywordflow">while</span> ( myFile.good() ) {
00477           myFile.getline(line, <a class="code" href="catalog_8h.html#a3">MAX_LINE</a>);
00478           tot++;
00479           i=strlen(line);
00480           <span class="keywordflow">if</span> (i &lt; 2) <span class="keywordflow">break</span>; <span class="comment">// in any case, stop on empty string contrary to</span>
00481                             <span class="comment">//  load() which continues, skipping lines</span>
00482           <span class="comment">// string max size is MAX_LINE-1;</span>
00483           <span class="keywordflow">if</span> (i &gt;= maxLine) {
00484             sortie &lt;&lt; <span class="stringliteral">"line #"</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">" exceeds maximal size ("</span>
00485                    &lt;&lt; <a class="code" href="catalog_8h.html#a3">MAX_LINE</a> &lt;&lt; <span class="stringliteral">")"</span>;
00486             <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, sortie.str());
00487             sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00488             err=<a class="code" href="namespacecatalog_access.html#a31a15">BAD_FILELINE</a>;
00489             <span class="keywordflow">break</span>;
00490           }
00491           <span class="comment">//if (testCR) line[--i]='\0';</span>
00492           posC=strncmp(line, <span class="stringliteral">"#Table"</span>, 6);
00493           <span class="keywordflow">if</span> (posC == 0) {
00494             <span class="comment">// should not happen, normally preceded by empty lines</span>
00495             sortie &lt;&lt; <span class="stringliteral">"line #"</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">": second table start (not read)"</span>;
00496             <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, sortie.str());
00497             sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00498             err=<a class="code" href="namespacecatalog_access.html#a31a18">BAD_ROW</a>;
00499             <span class="keywordflow">break</span>;
00500           }
00501         }
00502         <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a31a18">BAD_ROW</a>) err=<a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00503       }<span class="comment">// analyze_body() is OK</span>
00504  
00505       <span class="keywordflow">if</span> ((err &lt; IS_OK) &amp;&amp; (err &gt;= -3)) {
00506         sortie &lt;&lt; <span class="stringliteral">": FILENAME \""</span> &lt;&lt; fileName
00507             &lt;&lt; <span class="stringliteral">"\" has unknown type (stopped step "</span> &lt;&lt; 5-1*err &lt;&lt; <span class="stringliteral">")"</span>;
00508         <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, sortie.str());
00509         sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00510         err=<a class="code" href="namespacecatalog_access.html#a31a13">BAD_FILETYPE</a>;
00511       }
00512       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>) *nrows=tot-refRow;
00513       sortie &lt;&lt; <span class="stringliteral">"closing input text file: "</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">" lines read"</span>;
00514       <a class="code" href="namespacecatalog_access.html#a30">printLog</a>(0, sortie.str());
00515     }<span class="comment">// analyze_head() is OK</span>
00516     myFile.close();
00517 
00518   }<span class="comment">// file is read</span>
00519 
00520   <a class="code" href="classcatalog_access_1_1_catalog.html#c0">deleteDescription</a>();
00521   <span class="keywordflow">return</span> err;
00522 }
00523 <span class="comment">/**********************************************************************/</span>
00524 <span class="comment">// to know the maximal number of rows in the CDS catalog</span>
<a name="l00525"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a4">00525</a> <span class="keywordtype">int</span> Catalog::getMaxNumRowsWeb(<span class="keywordtype">long</span> *nrows, <span class="keyword">const</span> std::string catName,
00526                               <span class="keyword">const</span> std::string urlCode) {
00527 
00528   <span class="keywordtype">int</span> i, err;
00529   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos;
00530   std::string web, text, origin=<span class="stringliteral">"getMaxNumRowsWeb"</span>;
00531   *nrows=0;
00532   err=<a class="code" href="namespacecatalog_access.html#a31a16">BAD_URL</a>;
00533   <span class="keywordflow">if</span> (urlCode.length() == 0) {
00534     text=<span class="stringliteral">": CODE for URL (web http address) is empty"</span>;
00535     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00536     <span class="keywordflow">return</span> err;
00537   }
00538   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="catalog_8h.html#a2">MAX_URL</a>; i++) {
00539     text=Catalog::s_CatalogURL[i]; <span class="comment">/* convert C string to C++ string */</span>
00540     pos=text.find(<span class="charliteral">' '</span>);
00541     <span class="keywordflow">if</span> (pos == std::string::npos) <span class="keywordflow">continue</span>;
00542     <span class="keywordflow">if</span> (text.substr(0, pos) == urlCode) <span class="keywordflow">break</span>;
00543   }
00544   <span class="keywordflow">if</span> (i == <a class="code" href="catalog_8h.html#a2">MAX_URL</a>) {
00545     text=<span class="stringliteral">": CODE for URL (web http address) do not exist"</span>;
00546     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00547     <span class="keywordflow">return</span> err;
00548   }
00549   pos=text.rfind(<span class="charliteral">' '</span>);
00550   <span class="keywordflow">if</span> (pos == std::string::npos) web=text;
00551   <span class="keywordflow">else</span> web=text.substr(pos+1, text.length()-pos);
00552 
00553   <span class="keywordtype">int</span> iCat=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkCatName</a>(origin, catName);
00554   <span class="keywordflow">if</span> (iCat &lt; 0) <span class="keywordflow">return</span> iCat;
00555 
00556 <span class="comment">/* IS IT REALLY NEEDED ?</span>
00557 <span class="comment">  err=checkImport(origin, false);</span>
00558 <span class="comment">  if (err &lt; IS_VOID) return err;</span>
00559 <span class="comment">*/</span>
00560 <span class="comment">/* now, ASCII query must be created</span>
00561 <span class="comment">  and sent, using CDS package to given URL</span>
00562 <span class="comment">*/</span>
00563   err=-9;
00564   text=<span class="stringliteral">"Web query not implemented"</span>;
00565   <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00566 
00567   <span class="keywordflow">return</span> err;
00568 }
00569 
00570 
00571 <span class="comment">/**********************************************************************/</span>
00572 <span class="comment">/*  ACCESSING Catalog DEFINITION                                      */</span>
00573 <span class="comment">/**********************************************************************/</span>
00574 <span class="comment">// get the 3 definition strings</span>
<a name="l00575"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a15">00575</a> <span class="keywordtype">void</span> Catalog::getCatalogTitles(std::vector&lt;std::string&gt; *titles) {
00576 
00577   <span class="keywordtype">int</span> nb=titles-&gt;size();
00578   <span class="keywordflow">if</span> (nb == 0) titles-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>);
00579   <span class="keywordflow">else</span> (*titles)[0]=<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>;
00580   <span class="keywordflow">if</span> (nb &gt; 1) (*titles)[1]=<a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a>;       <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00581   <span class="keywordflow">if</span> (nb &gt; 2) (*titles)[2]=<a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>;   <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00582   <span class="keywordflow">if</span> (nb &gt; 3) (*titles)[3]=<a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>;    <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00583   <span class="keywordflow">if</span> (nb &gt; 4) (*titles)[4]=<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>; <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00584   <span class="keywordflow">if</span> (nb &gt; 5) (*titles)[5]=<a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00585 }
00586 
00587 <span class="comment">/**********************************************************************/</span>
00588 <span class="comment">// get an iterator on the quantities</span>
00589 
00590 
00591 <span class="comment">/**********************************************************************/</span>
00592 <span class="comment">// get a copy of the quantity vector</span>
<a name="l00593"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a16">00593</a> <span class="keywordtype">int</span> Catalog::getQuantityDescription(std::vector&lt;Quantity&gt; *myQuantities) {
00594 
00595   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(<span class="stringliteral">"getQuantityDescription"</span>, <span class="keyword">true</span>);
00596   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) {
00597     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getQuantityDescription"</span>, <span class="stringliteral">"returning unchanged vector."</span>);
00598     <span class="keywordflow">return</span> quantSize;
00599   }
00600   *myQuantities=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>;
00601   <span class="keywordflow">return</span> quantSize;
00602 }
00603 
00604 <span class="comment">/**********************************************************************/</span>
00605 <span class="comment">// get only Quantity member name</span>
<a name="l00606"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a17">00606</a> <span class="keywordtype">int</span> Catalog::getQuantityNames(std::vector&lt;std::string&gt; *names) {
00607 
00608   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityNames"</span>;
00609   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
00610   names-&gt;clear();
00611   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) {
00612     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00613     <span class="keywordflow">return</span> quantSize;
00614   }
00615   <span class="keywordflow">try</span> {
00616     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00617       names-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_name);
00618   }
00619   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00620     std::string errText;
00621     errText=std::string(<span class="stringliteral">"EXCEPTION on names: "</span>)+err.what();
00622     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, errText);
00623     <span class="keywordflow">throw</span>;
00624   }
00625   <span class="keywordflow">return</span> quantSize;
00626 }
00627 <span class="comment">/**********************************************************************/</span>
00628 <span class="comment">// get only Quantity member unit</span>
<a name="l00629"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a18">00629</a> <span class="keywordtype">int</span> Catalog::getQuantityUnits(std::vector&lt;std::string&gt; *units) {
00630 
00631   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityUnits"</span>;
00632   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
00633   units-&gt;clear();
00634   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) {
00635     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00636     <span class="keywordflow">return</span> quantSize;
00637   } 
00638   <span class="keywordflow">try</span> {
00639     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00640       units-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_unit);
00641   }
00642   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00643     std::string errText;
00644     errText=std::string(<span class="stringliteral">"EXCEPTION on units: "</span>)+err.what();
00645     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, errText);
00646     <span class="keywordflow">throw</span>;
00647   }
00648   <span class="keywordflow">return</span> quantSize;
00649 }
00650 <span class="comment">/**********************************************************************/</span>
00651 <span class="comment">// get only Quantity member ucd</span>
<a name="l00652"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a19">00652</a> <span class="keywordtype">int</span> Catalog::getQuantityUCDs (std::vector&lt;std::string&gt; *ucds) {
00653 
00654   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityUCDs"</span>;
00655   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
00656   ucds-&gt;clear();
00657   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) {
00658     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00659     <span class="keywordflow">return</span> quantSize;
00660   } 
00661   <span class="keywordflow">try</span> {
00662     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00663       ucds-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_ucd);
00664   }
00665   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00666     std::string errText;
00667     errText=std::string(<span class="stringliteral">"EXCEPTION on ucds: "</span>)+err.what();
00668     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, errText);
00669     <span class="keywordflow">throw</span>;
00670   }
00671   <span class="keywordflow">return</span> quantSize;
00672 }
00673 <span class="comment">/**********************************************************************/</span>
00674 <span class="comment">// get only Quantity member type</span>
<a name="l00675"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a20">00675</a> <span class="keywordtype">int</span> Catalog::getQuantityTypes(std::vector&lt;Quantity::QuantityType&gt; *types) {
00676 
00677   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityTypes"</span>;
00678   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
00679   types-&gt;clear();
00680   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) {
00681     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00682     <span class="keywordflow">return</span> quantSize;
00683   } 
00684   <span class="keywordflow">try</span> {
00685     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00686       types-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_type);
00687   }
00688   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00689     std::string errText;
00690     errText=std::string(<span class="stringliteral">"EXCEPTION on types: "</span>)+err.what();
00691     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, errText);
00692     <span class="keywordflow">throw</span>;
00693   }
00694   <span class="keywordflow">return</span> quantSize;
00695 }
00696 
00697 <span class="comment">/**********************************************************************/</span>
00698 <span class="comment">// get the member "statErrName" of given quantity "name"</span>
<a name="l00699"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a21">00699</a> <span class="keywordtype">int</span> Catalog::getStatErrorName(<span class="keyword">const</span> std::string name,
00700                               std::string *statErrName) {
00701 
00702   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(<span class="stringliteral">"getStatErrorName"</span>, <span class="keyword">true</span>);
00703   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> quantSize;
00704   quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(<span class="stringliteral">"getStatErrorName"</span>, name);
00705   <span class="keywordflow">if</span> (quantSize &lt; 0) <span class="keywordflow">return</span> quantSize;
00706   *statErrName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(quantSize).m_statError;
00707   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00708 }
00709 <span class="comment">/**********************************************************************/</span>
00710 <span class="comment">// get the member "sysErrName" of given quantity "name"</span>
<a name="l00711"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a22">00711</a> <span class="keywordtype">int</span> Catalog::getSysErrorName(<span class="keyword">const</span> std::string name,
00712                              std::string *sysErrName) {
00713 
00714   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(<span class="stringliteral">"getSysErrorName"</span>, <span class="keyword">true</span>);
00715   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> quantSize;
00716   quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(<span class="stringliteral">"getSysErrorName"</span>, name);
00717   <span class="keywordflow">if</span> (quantSize &lt; 0) <span class="keywordflow">return</span> quantSize;
00718   *sysErrName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(quantSize).m_sysError;
00719   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00720 }
00721   
00722 <span class="comment">/**********************************************************************/</span>
00723 <span class="comment">// get the list of names of the quantities which form the given vector "name"</span>
00724 
00725 
00726 
00727 <span class="comment">/**********************************************************************/</span>
00728 <span class="comment">/*  ACCESSING ALL Catalog CONTENTS in MEMORY (IGNORING SELECTION)     */</span>
00729 <span class="comment">/**********************************************************************/</span>
00730 <span class="comment">// get the number of rows in the catalog</span>
<a name="l00731"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a24">00731</a> <span class="keywordtype">void</span> Catalog::getNumRows(<span class="keywordtype">long</span> *nrows) {
00732 
00733   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0) *nrows=0;
00734   <span class="keywordflow">else</span> *nrows=<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>;
00735 }
00736 
00737 <span class="comment">/**********************************************************************/</span>
00738 <span class="comment">// get the value of given string quantity in given row</span>
<a name="l00739"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a25">00739</a> <span class="keywordtype">int</span> Catalog::getSValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00740                        std::string *stringVal) {
00741 
00742   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSValue"</span>;
00743   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
00744   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00745   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00746   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00747   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00748     std::string errText;
00749     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00750     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00751     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00752   }
00753   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00754 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00755 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG STRING index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00756 <span class="preprocessor">  #endif</span>
00757 <span class="preprocessor"></span>  *stringVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(row);
00758   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00759 }
00760 <span class="comment">/**********************************************************************/</span>
00761 <span class="comment">// get the value of given numerical quantity in given row</span>
<a name="l00762"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a26">00762</a> <span class="keywordtype">int</span> Catalog::getNValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00763                        <span class="keywordtype">double</span> *realVal) {
00764 
00765   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNValue"</span>;
00766   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
00767   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00768   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00769   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00770   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {  
00771     std::string errText;
00772     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00773     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00774     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00775   }
00776   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00777 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00778 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00779 <span class="preprocessor">  #endif</span>
00780 <span class="preprocessor"></span>  *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00781   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00782 }
00783 
00784 <span class="comment">/**********************************************************************/</span>
00785 <span class="comment">// get the values of given vector quantity in given row</span>
00786 
00787 <span class="comment">/**********************************************************************/</span>
00788 <span class="comment">// get the value of the statistical error of given quantity in given row</span>
<a name="l00789"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a27">00789</a> <span class="keywordtype">int</span> Catalog::getStatError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00790                           <span class="keywordtype">double</span> *realValStat) {
00791 
00792   *realValStat = -1.0;
00793   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getStatError"</span>;
00794   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
00795   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00796   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00797   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00798   std::string statName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_statError;
00799   <span class="keywordflow">if</span> (statName.empty()) {;
00800     statName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no statistical error"</span>;
00801     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, statName);
00802     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a21">NO_QUANT_ERR</a>;
00803   }
00804   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, statName);
00805   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00806   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00807 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00808 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM STAT index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00809 <span class="preprocessor">  #endif</span>
00810 <span class="preprocessor"></span>  *realValStat=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00811   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00812 }
00813 <span class="comment">/**********************************************************************/</span>
00814 <span class="comment">// get the value of the systematic error of given quantity in given row</span>
<a name="l00815"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a28">00815</a>   <span class="keywordtype">int</span> Catalog::getSysError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00816                            <span class="keywordtype">double</span> *realValSys) {
00817 
00818   *realValSys = -1.0;
00819   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSysError"</span>;
00820   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
00821   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00822   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00823   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00824   std::string sysName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_sysError;
00825   <span class="keywordflow">if</span> (sysName.empty()) {
00826     sysName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no systematic error"</span>;
00827     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, sysName);
00828     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a21">NO_QUANT_ERR</a>;
00829   }
00830   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, sysName);
00831   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00832   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00833 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00834 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM SYS. index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00835 <span class="preprocessor">  #endif</span>
00836 <span class="preprocessor"></span>  *realValSys=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00837   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00838 }
00839 
00840 <span class="comment">/**********************************************************************/</span>
00841 <span class="comment">// get the values of the statistical error of given vector in given row</span>
00842 
00843 <span class="comment">/**********************************************************************/</span>
00844 <span class="comment">// get the values of the systematic error of given vector in given row</span>
00845 
00846 
00847 <span class="comment">/**********************************************************************/</span>
00848 <span class="comment">// for string quantity: the list of different values assumed</span>
<a name="l00849"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a29">00849</a> <span class="keywordtype">int</span> Catalog::getSValues(<span class="keyword">const</span> std::string name,
00850                         std::vector&lt;std::string&gt; *values) {
00851 
00852   values-&gt;clear();
00853   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSValues"</span>;
00854   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, 0);
00855   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00856   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00857   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00858   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00859     std::string errText;
00860     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00861     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00862     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00863   }
00864   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00865   std::string text;
00866   <span class="keywordflow">try</span> {
00867     values-&gt;assign(1, <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(0));
00868     <span class="keywordtype">long</span> i, j, max;
00869     <span class="keywordflow">for</span> (i=1; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) {
00870       text=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i);
00871       max=values-&gt;size();
00872       <span class="keywordflow">for</span> (j=0; j&lt;max; j++) <span class="keywordflow">if</span> (values-&gt;at(j) == text) <span class="keywordflow">break</span>;
00873       <span class="keywordflow">if</span> (j == max) values-&gt;push_back(text);
00874     }
00875   }
00876   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00877     text=std::string(<span class="stringliteral">"EXCEPTION on values: "</span>)+err.what();
00878     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
00879     <span class="keywordflow">throw</span>;
00880   }
00881   <span class="keywordflow">return</span> values-&gt;size();
00882 }
00883 
00884 <span class="comment">/**********************************************************************/</span>
00885 <span class="comment">// for numerical quantity: the minimum value in the catalog</span>
<a name="l00886"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a30">00886</a> <span class="keywordtype">int</span> Catalog::minVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
00887 
00888   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
00889   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"minVal"</span>;
00890   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, 0);
00891   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00892   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00893   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00894   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
00895     std::string errText;
00896     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00897     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00898     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00899   }
00900   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00901   <span class="keywordtype">long</span> i=0;
00902   <span class="keywordtype">double</span> r;
00903   <span class="keywordflow">do</span> { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00904 <span class="comment">/*  std::cout &lt;&lt; "NaN == NaN ? " &lt;&lt; (*realVal == m_numericals[num].at(0))</span>
00905 <span class="comment">            &lt;&lt; std::endl;*/</span>
00906   }
00907   <span class="keywordflow">while</span> ((isnan(*realVal)) &amp;&amp; (++i &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>));
00908   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) {
00909     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00910     <span class="keywordflow">if</span> (r &lt; *realVal) *realVal=r;
00911   }
00912   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00913 }
00914 <span class="comment">/**********************************************************************/</span>
00915 <span class="comment">// for numerical quantity: the maximum value in the catalog</span>
<a name="l00916"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a31">00916</a> <span class="keywordtype">int</span> Catalog::maxVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
00917 
00918   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
00919   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"maxVal"</span>;
00920   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, 0);
00921   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00922   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00923   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00924   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
00925     std::string errText;
00926     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00927     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00928     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00929   }
00930   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00931   <span class="keywordtype">long</span> i=0;
00932   <span class="keywordtype">double</span> r;
00933   <span class="keywordflow">do</span> { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); }
00934   <span class="keywordflow">while</span> ((isnan(*realVal)) &amp;&amp; (++i &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>));
00935   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) {
00936     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00937     <span class="keywordflow">if</span> (r &gt; *realVal) *realVal=r;
00938   }
00939   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00940 }
00941 
00942 
00943 <span class="comment">/**********************************************************************/</span>
00944 <span class="comment">/*  ACCESSING the Catalog CONTENTS with in-memory SELECTION CRITERIA  */</span>
00945 <span class="comment">/**********************************************************************/</span>
00946 <span class="comment">// get the number of selected rows in the catalog</span>
<a name="l00947"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a32">00947</a> <span class="keywordtype">void</span> Catalog::getNumSelRows(<span class="keywordtype">long</span> *nrows) {
00948 
00949  *nrows=<a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>;
00950 }
00951 
00952 <span class="comment">/**********************************************************************/</span>
00953 <span class="comment">// get the value of given string quantity in given selected row</span>
<a name="l00954"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a33">00954</a> <span class="keywordtype">int</span> Catalog::getSelSValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00955                           std::string *stringVal) {
00956 
00957   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSValue"</span>;
00958   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, srow);
00959   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00960   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00961   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00962   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00963   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00964     std::string errText;
00965     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00966     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00967     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00968   }
00969   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00970   <span class="keywordtype">long</span> tot=0;
00971   <span class="comment">// first bit indicates global selection</span>
00972   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00973     <span class="keywordflow">if</span> (tot == srow) { *stringVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i); <span class="keywordflow">break</span>; }
00974     tot++;
00975     <span class="comment">//if (tot == m_numSelRows) break; should not happen</span>
00976   }
00977   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
00978   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
00979 }
00980 <span class="comment">/**********************************************************************/</span>
00981 <span class="comment">// get the value of given numerical quantity in given selected row</span>
<a name="l00982"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a34">00982</a> <span class="keywordtype">int</span> Catalog::getSelNValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00983                           <span class="keywordtype">double</span> *realVal) {
00984 
00985   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelNValue"</span>;
00986   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, srow);
00987   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
00988   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00989   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
00990   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00991   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {  
00992     std::string errText;
00993     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00994     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
00995     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
00996   }
00997   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00998   <span class="keywordtype">long</span> tot=0;
00999   <span class="comment">// first bit indicates global selection</span>
01000   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01001     <span class="keywordflow">if</span> (tot == srow) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
01002     tot++;
01003     <span class="comment">//if (tot == m_numSelRows) break; should not happen</span>
01004   }
01005   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01006   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
01007 }
01008 
01009 <span class="comment">/**********************************************************************/</span>
01010 <span class="comment">// get the values of given vector quantity in given selected row</span>
01011 
01012 <span class="comment">/**********************************************************************/</span>
01013 <span class="comment">// get value of the statistical error of given quantity in given selected row</span>
<a name="l01014"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a35">01014</a> <span class="keywordtype">int</span> Catalog::getSelStatError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
01015                              <span class="keywordtype">double</span> *realValStat) {
01016 
01017   *realValStat = -1.0;
01018   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelStatError"</span>;
01019   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, srow);
01020   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01021   <span class="comment">// above test avoid searching for srow when no row is selected</span>
01022   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
01023   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01024   std::string statName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_statError;
01025   <span class="keywordflow">if</span> (statName.empty()) {;
01026     statName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no statistical error"</span>;
01027     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, statName);
01028     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a21">NO_QUANT_ERR</a>;
01029   }
01030   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, statName);
01031   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01032   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01033 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
01034 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM STAT index = "</span> &lt;&lt; num &lt;&lt; std::endl;
01035 <span class="preprocessor">  #endif</span>
01036 <span class="preprocessor"></span>  <span class="keywordtype">long</span> tot=0;
01037   <span class="comment">// first bit indicates global selection</span>
01038   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01039     <span class="keywordflow">if</span> (tot == srow) { *realValStat=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
01040     tot++;
01041   }
01042   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01043   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
01044 }
01045 <span class="comment">/**********************************************************************/</span>
01046 <span class="comment">// get value of the systematic error of given quantity in given selected row</span>
<a name="l01047"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a36">01047</a> <span class="keywordtype">int</span> Catalog::getSelSysError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
01048                              <span class="keywordtype">double</span> *realValSys) {
01049 
01050   *realValSys = -1.0;
01051   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSysError"</span>;
01052   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, srow);
01053   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01054   <span class="comment">// above test avoid searching for srow when no row is selected</span>
01055   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
01056   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01057   std::string sysName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_sysError;
01058   <span class="keywordflow">if</span> (sysName.empty()) {;
01059     sysName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no systematic error"</span>;
01060     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, sysName);
01061     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a21">NO_QUANT_ERR</a>;
01062   }
01063   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, sysName);
01064   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01065   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01066 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
01067 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM SYS. index = "</span> &lt;&lt; num &lt;&lt; std::endl;
01068 <span class="preprocessor">  #endif</span>
01069 <span class="preprocessor"></span>  <span class="keywordtype">long</span> tot=0;
01070   <span class="comment">// first bit indicates global selection</span>
01071   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01072     <span class="keywordflow">if</span> (tot == srow) { *realValSys=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
01073     tot++;
01074   }
01075   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01076   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
01077 }
01078 <span class="comment">/**********************************************************************/</span>
01079 <span class="comment">// get the values of the statistical error of given vector in given selected row</span>
01080 
01081 <span class="comment">/**********************************************************************/</span>
01082 <span class="comment">// get the values of the systematic error of given vector in given selected row</span>
01083 
01084 
01085 <span class="comment">/**********************************************************************/</span>
01086 <span class="comment">// for string quantity: the list of different selected values assumed</span>
<a name="l01087"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a37">01087</a> <span class="keywordtype">int</span> Catalog::getSelSValues(<span class="keyword">const</span> std::string name,
01088                            std::vector&lt;std::string&gt; *values) {
01089 
01090   values-&gt;clear();
01091   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSValues"</span>;
01092   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, 0);
01093   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01094   <span class="comment">// above test avoid searching when no row is selected</span>
01095   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
01096   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01097   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
01098     std::string errText;
01099     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
01100     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
01101     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
01102   }
01103   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01104   std::string text;
01105   <span class="keywordflow">try</span> {
01106     <span class="keywordtype">long</span> j, max=0, tot=0;
01107     <span class="comment">// first bit indicates global selection</span>
01108     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01109       text=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i);
01110       <span class="keywordflow">if</span> (max == 0) {values-&gt;assign(1, text); max++;}
01111       <span class="keywordflow">else</span> {
01112         <span class="keywordflow">for</span> (j=0; j&lt;max; j++) <span class="keywordflow">if</span> (values-&gt;at(j) == text) <span class="keywordflow">break</span>;
01113         <span class="keywordflow">if</span> (j == max) {values-&gt;push_back(text); max++;}
01114       }
01115       <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01116     }
01117   }
01118   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
01119     text=std::string(<span class="stringliteral">"EXCEPTION on values: "</span>)+err.what();
01120     <a class="code" href="namespacecatalog_access.html#a28">printErr</a>(origin, text);
01121     <span class="keywordflow">throw</span>;
01122   }
01123   <span class="keywordflow">return</span> values-&gt;size();
01124 }
01125 
01126 <span class="comment">/**********************************************************************/</span>
01127 <span class="comment">// for numerical quantity: the minimum value in the selected rows</span>
<a name="l01128"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a38">01128</a> <span class="keywordtype">int</span> Catalog::minSelVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
01129 
01130   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
01131   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"minSelVal"</span>;
01132   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, 0);
01133   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01134   <span class="comment">// above test avoid searching when no row is selected</span>
01135   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
01136   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01137   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
01138     std::string errText;
01139     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
01140     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
01141     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
01142   }
01143   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01144 
01145   <span class="keywordtype">long</span> i, tot=0;
01146   <span class="keywordtype">double</span> r;
01147   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01148     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01149     <span class="keywordflow">if</span> (!isnan(*realVal)) <span class="keywordflow">break</span>;
01150     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01151   }
01152   <span class="keywordflow">if</span> (tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01153   <span class="comment">// stop when selection contains only NaN</span>
01154   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01155     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01156     <span class="keywordflow">if</span> (r &lt; *realVal) *realVal=r;
01157     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01158   }
01159   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01160 }
01161 <span class="comment">/**********************************************************************/</span>
01162 <span class="comment">// for numerical quantity: the maximum value in the selected rows</span>
<a name="l01163"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a39">01163</a> <span class="keywordtype">int</span> Catalog::maxSelVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
01164 
01165   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
01166   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"maxSelVal"</span>;
01167   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, 0);
01168   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01169   <span class="comment">// above test avoid searching when no row is selected</span>
01170   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkQuant_name</a>(origin, name);
01171   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01172   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
01173     std::string errText;
01174     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
01175     <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, errText);
01176     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a20">BAD_QUANT_TYPE</a>;
01177   }
01178   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01179 
01180   <span class="keywordtype">long</span> i, tot=0;
01181   <span class="keywordtype">double</span> r;
01182   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01183     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01184     <span class="keywordflow">if</span> (!isnan(*realVal)) <span class="keywordflow">break</span>;
01185     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01186   }
01187   <span class="keywordflow">if</span> (tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01188   <span class="comment">// stop when selection contains only NaN</span>
01189   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01190     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01191     <span class="keywordflow">if</span> (r &gt; *realVal) *realVal=r;
01192     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01193   }
01194   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01195 }
01196 
01197 
01198 <span class="comment">/**********************************************************************/</span>
01199 <span class="comment">/*  ACCESSING the Catalog GENERIC CONTENTS                            */</span>
01200 <span class="comment">/**********************************************************************/</span>
01201 <span class="comment">// access to generic quantity for RA  (degrees)</span>
<a name="l01202"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a40">01202</a> <span class="keywordtype">int</span> Catalog::ra_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal, <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01203 
01204   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"ra_deg"</span>;
01205   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a> &lt; 0) {
01206     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0)
01207       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01208     <span class="keywordflow">else</span>
01209       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"missing generic RA position quantity"</span>);
01210     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a17">NO_RA_DEC</a>;
01211   }
01212   <span class="keywordtype">int</span> num;
01213   <span class="keywordflow">if</span> (!inSelection) {
01214     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
01215     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01216     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a>].m_index;
01217     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
01218   }
01219   <span class="keywordflow">else</span> {
01220     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, row);
01221     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01222     <span class="keywordtype">long</span> tot=0;
01223     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a>].m_index;
01224     <span class="comment">// first bit indicates global selection</span>
01225     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01226       <span class="keywordflow">if</span> (tot == row) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k); <span class="keywordflow">break</span>; }
01227       tot++;
01228     }
01229     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
01230   }
01231   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01232 }
01233 <span class="comment">/**********************************************************************/</span>
01234 <span class="comment">// access to generic quantity for DEC (degrees)</span>
<a name="l01235"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a41">01235</a> <span class="keywordtype">int</span> Catalog::dec_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal, <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01236 
01237   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"dec_deg"</span>;
01238   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a> &lt; 0) {
01239     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0)
01240       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01241     <span class="keywordflow">else</span>
01242       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"missing generic DEC position quantity"</span>);
01243     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a17">NO_RA_DEC</a>;
01244   }
01245   <span class="keywordtype">int</span> num;
01246   <span class="keywordflow">if</span> (!inSelection) {
01247     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
01248     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01249     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a>].m_index;
01250     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
01251   }
01252   <span class="keywordflow">else</span> {
01253     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, row);
01254     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01255     <span class="keywordtype">long</span> tot=0;
01256     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a>].m_index;
01257     <span class="comment">// first bit indicates global selection</span>
01258     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01259       <span class="keywordflow">if</span> (tot == row) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k); <span class="keywordflow">break</span>; }
01260       tot++;
01261     }
01262     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
01263   }
01264   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01265 }
01266 <span class="comment">/**********************************************************************/</span>
01267 <span class="comment">// access to generic quantity for position uncertainty (degrees)</span>
<a name="l01268"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a42">01268</a> <span class="keywordtype">int</span> Catalog::posError_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal,
01269                           <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01270 
01271   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"posError_deg"</span>;
01272   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a> &lt; 0) {
01273     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0)
01274       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01275     <span class="keywordflow">else</span>
01276       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(origin, <span class="stringliteral">"missing generic position error quantity"</span>);
01277     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a19">BAD_QUANT_NAME</a>;
01278   }
01279   <span class="keywordtype">int</span> num;
01280   <span class="keywordflow">if</span> (!inSelection) {
01281     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkSize_row</a>(origin, row);
01282     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01283     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>].m_index;
01284     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row)/<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
01285   }
01286   <span class="keywordflow">else</span> {
01287     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c27">checkSel_row</a>(origin, row);
01288     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> num;
01289     <span class="keywordtype">long</span> tot=0;
01290     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>].m_index;
01291     <span class="comment">// first bit indicates global selection</span>
01292     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01293       <span class="keywordflow">if</span> (tot == row) {
01294         *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k)/<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
01295         <span class="keywordflow">break</span>;
01296       }
01297       tot++;
01298     }
01299     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>; <span class="comment">// should not happen</span>
01300   }
01301   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a31a7">IS_OK</a>;
01302 }
01303 
01304 <span class="comment">/**********************************************************************/</span>
01305 <span class="comment">// 6 methods returning the name of generic quantities</span>
<a name="l01306"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a43">01306</a> std::string Catalog::getNameRA() {
01307   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a> &lt; 0) {
01308     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0)
01309       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getNameRA"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01310     <span class="keywordflow">else</span>
01311       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getNameRA"</span>, <span class="stringliteral">"missing generic RA position quantity"</span>);
01312     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01313   }
01314   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexRA</a>].m_name;
01315 }
<a name="l01316"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a44">01316</a> std::string Catalog::getNameDEC() {
01317   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a> &lt; 0) {
01318     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0)
01319       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getNameDEC"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01320     <span class="keywordflow">else</span>
01321       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getNameDEC"</span>, <span class="stringliteral">"missing generic DEC position quantity"</span>);
01322     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01323   }
01324   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexDEC</a>].m_name;
01325 }
<a name="l01326"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a45">01326</a> std::string Catalog::getNamePosErr() {
01327   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>&lt; 0) {
01328     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numRows</a> &lt; 0)
01329       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getNamePosErr"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01330     <span class="keywordflow">else</span>
01331       <a class="code" href="namespacecatalog_access.html#a29">printWarn</a>(<span class="stringliteral">"getNamePosErr"</span>, <span class="stringliteral">"missing generic position error quantity"</span>);
01332     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01333   }
01334   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_indexErr</a>].m_name;
01335 }
01336 
<a name="l01337"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a46">01337</a> std::string Catalog::getNameL() {
01338   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameL"</span>;
01339   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
01340   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01341   <span class="keywordtype">int</span> i;
01342   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01343     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01344         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_ucd == Catalog::s_genericL))
01345       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01346   }
01347   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01348 }
<a name="l01349"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a47">01349</a> std::string Catalog::getNameB() {
01350   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameB"</span>;
01351   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
01352   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01353   <span class="keywordtype">int</span> i;
01354   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01355     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01356         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_ucd == Catalog::s_genericB))
01357       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01358   }
01359   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01360 }
01361 
<a name="l01362"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a48">01362</a> std::string Catalog::getNameObjName() {
01363   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameObjName"</span>;
01364   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkImport</a>(origin, <span class="keyword">true</span>);
01365   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a31a8">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01366   <span class="keywordtype">int</span> i;
01367   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01368     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01369         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_type == Quantity::STRING))
01370       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01371   }
01372   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01373 }
01374 
01375 } <span class="comment">// namespace catalogAccess</span>
</pre></div><hr><address style="align: right;"><small>Generated on Tue Jun 28 10:46:02 2005 for catalogAccess by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
