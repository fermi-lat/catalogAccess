<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>catalog.cxx Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.18 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>catalog.cxx</h1><a href="catalog_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00014 <span class="preprocessor">#include "<a class="code" href="catalog_8h.html">catalog.h</a>"</span>
00015 
<a name="l00016"></a><a class="code" href="namespacecatalog_access.html">00016</a> <span class="keyword">namespace </span>catalogAccess {
00017 
00018 <span class="comment">/**********************************************************************/</span>
00019 <span class="comment">/*  DEFINING CLASS CONSTANTS                                          */</span>
00020 <span class="comment">/**********************************************************************/</span>
00021 
00022 <span class="comment">// available mirror sites for VizieR (from CDS)</span>
<a name="l00023"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r0">00023</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogURL[<a class="code" href="catalog_8h.html#a2">MAX_URL</a>]={
00024       <span class="stringliteral">"cds   fr vizier.u-strasbg.fr/"</span>,    <span class="comment">//CDS - Strasbourg, France</span>
00025       <span class="stringliteral">"cfa   us vizier.cfa.harvard.edu/"</span>, <span class="comment">//CFA - Harvard, USA</span>
00026       <span class="stringliteral">"cadc  ca vizier.hia.nrc.ca/"</span>,      <span class="comment">//CADC - Canada</span>
00027       <span class="stringliteral">"adac  jp vizier.nao.ac.jp/"</span>,       <span class="comment">//ADAC - Tokyo, Japan</span>
00028       <span class="stringliteral">"ukirt hawaii www.ukirt.jach.hawaii.edu/"</span>, <span class="comment">//JAC - Hawaii, USA</span>
00029       <span class="stringliteral">"cambridge uk archive.ast.cam.ac.uk/"</span>,
00030       <span class="stringliteral">"iucaa in urania.iucaa.ernet.in/"</span>,  <span class="comment">//IUCAA - Pune, India</span>
00031       <span class="stringliteral">"moscow ru www.inasan.rssi.ru/"</span>,    <span class="comment">//INASAN - Russia (DOES IT WORK ?)</span>
00032       <span class="stringliteral">"bejing cn data.bao.ac.cn/"</span>         <span class="comment">//Bejing Obs. - China</span>
00033       };
00034 
00035 <span class="comment">// information on catalog size laste updated on: JAN 2005</span>
<a name="l00036"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r1">00036</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogList[2*<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>]={
00037       <span class="stringliteral">"EGRET3 sources"</span>, <span class="stringliteral">"J/ApJS/123/79/3eg"</span>,    <span class="comment">//   271 rows (20 columns)</span>
00038       <span class="stringliteral">"EGRET3 fluxes"</span>,  <span class="stringliteral">"J/ApJS/123/79/fluxes"</span>, <span class="comment">//  5245 rows (10 columns)</span>
00039       <span class="stringliteral">"EGRET3 periods"</span>, <span class="stringliteral">"J/ApJS/123/79/table1"</span>, <span class="comment">//   169 rows ( 6 columns)</span>
00040       <span class="stringliteral">"ROSAT 1RXS"</span>,     <span class="stringliteral">"IX/10A/1rxs"</span>,          <span class="comment">// 18806 rows (28 columns)</span>
00041       <span class="stringliteral">"Veron (11th) quasar"</span>, <span class="stringliteral">"VII/235/table1"</span>,  <span class="comment">// 48921 rows (21 columns)</span>
00042       <span class="stringliteral">"Veron (11th) BL Lac"</span>, <span class="stringliteral">"VII/235/table2"</span>,  <span class="comment">//   876 rows (21 columns)</span>
00043       <span class="stringliteral">"Veron (11th) AGN"</span>,    <span class="stringliteral">"VII/235/table3"</span>,  <span class="comment">// 15069 rows (21 columns)</span>
00044       <span class="stringliteral">"WGACAT of ROSAT"</span>,     <span class="stringliteral">"IX/31/wgacat"</span>,    <span class="comment">// 88621 rows (101 columns)</span>
00045       <span class="stringliteral">"ROSAT faint sources"</span>, <span class="stringliteral">"IX/29/rass_fsc"</span>,  <span class="comment">//105924 rows (30 columns)</span>
00046       <span class="stringliteral">"Green galactic SNR"</span>,  <span class="stringliteral">"VII/227/snrs"</span>     <span class="comment">//   231 rows (14 columns)</span>
00047       };
00048 
00049 
<a name="l00050"></a><a class="code" href="classcatalog_access_1_1_catalog.html#r2">00050</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *Catalog::s_CatalogGeneric[<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>][<a class="code" href="catalog_8h.html#a1">MAX_GEN</a>]={
00051      {<span class="stringliteral">"3EG"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"theta95"</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00052      {<span class="stringliteral">"3EG"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="stringliteral">""</span>},
00053      {<span class="stringliteral">""</span>,    <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00054      {<span class="stringliteral">"1RXS"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"PosErr"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},
00055      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// original format of RA/DEC</span>
00056      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// is in sexagesimal</span>
00057      {<span class="stringliteral">"Name"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},   <span class="comment">// ==&gt; need to be added in decimal</span>
00058      {<span class="stringliteral">"1WGA"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"ErrorRad"</span>, <span class="stringliteral">"GLON"</span>, <span class="stringliteral">"GLAT"</span>},
00059      {<span class="stringliteral">"1RXS"</span>, <span class="stringliteral">"RAJ2000"</span>, <span class="stringliteral">"DEJ2000"</span>, <span class="stringliteral">"PosErr"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>},
00060      {<span class="stringliteral">"SNR"</span>,  <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"+"</span>, <span class="stringliteral">"+"</span>}   <span class="comment">// RA/DEC is in sexagesimal</span>
00061 };
00062 
00063 
00064 <span class="comment">/**********************************************************************/</span>
00065 <span class="comment">// erase m_strings, m_numericals but keep catalog definition</span>
<a name="l00066"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a23">00066</a> <span class="keywordtype">void</span> Catalog::deleteContent() {
00067 
00068   <span class="keywordtype">int</span> vecSize, i;
00069   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=0;
00070   <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>=0;
00071   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.size();
00072   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00073     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[i].clear();
00074     <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.clear();
00075   }
00076   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.size();
00077   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00078     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[i].clear();
00079     <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.clear();
00080   }
00081   vecSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.size();
00082   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00083     <span class="keywordflow">for</span> (i=0; i&lt;vecSize; i++) <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[i].clear();
00084     <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.clear();
00085   }
00086 }
00087 <span class="comment">/**********************************************************************/</span>
00088 <span class="comment">// erase catalog definition (private method)</span>
<a name="l00089"></a><a class="code" href="classcatalog_access_1_1_catalog.html#c0">00089</a> <span class="keywordtype">void</span> Catalog::deleteDescription() {
00090 
00091   <a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>=<span class="stringliteral">""</span>;
00092   <a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a> =<span class="stringliteral">""</span>;
00093   <a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>   =<span class="stringliteral">""</span>;
00094   <a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>    =<span class="stringliteral">""</span>;
00095   <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> =<span class="stringliteral">""</span>;
00096   <a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>  =<span class="stringliteral">""</span>;
00097   <span class="keywordflow">if</span> ( <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.is_open() ) <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.close();
00098   <a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>   =0;
00099   <a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a> = -1.0;
00100   <a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>=1.0;  <span class="comment">// "deg" by default</span>
00101   <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.clear();
00102   <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.clear();
00103 
00104   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>   =<a class="code" href="namespacecatalog_access.html#a35a14">IMPORT_NEED</a>;
00105   <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>=0;
00106   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numReadRows</a>=0;
00107   <a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_selection</a>=<span class="stringliteral">""</span>;
00108   <a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selRegion</a>=<span class="keyword">false</span>;
00109   <a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.clear();
00110   <a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>= -1;
00111   <a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a> = -1;
00112   <a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>= -1;
00113 }
00114 <span class="comment">/**********************************************************************/</span>
00115 <span class="comment">// erase elements in m_quantities according to m_loadQuantity,</span>
00116 <span class="comment">// deleteContent() MUST be done before</span>
<a name="l00117"></a><a class="code" href="classcatalog_access_1_1_catalog.html#c1">00117</a> <span class="keywordtype">void</span> Catalog::deleteQuantities() {
00118 
00119   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxSize=<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.size();
00120   <span class="keywordtype">int</span>  nbA=0, nbD=0;
00121 
00122   <span class="keywordflow">if</span> (maxSize != <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.size()) {
00123     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"deleteQuantities"</span>,
00124              <span class="stringliteral">"problem in code, this error should not occur"</span>);
00125     <span class="keywordflow">return</span>;
00126   }
00127   <span class="comment">/* these vectors can be set if import was succesful with 0 row */</span>
00128   <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.clear();
00129   <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.clear();
00130   <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.clear();
00131   std::vector&lt;Quantity&gt;::iterator quantIter;
00132   quantIter=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.begin();
00133   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;maxSize; i++) {
00134     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>[i]) {<span class="comment">/* change the index in 2D tables */</span>
00135       <span class="keywordflow">if</span> ((*quantIter).m_format[0] == <span class="charliteral">'A'</span>) (*quantIter).m_index=nbA++;
00136       <span class="keywordflow">else</span> (*quantIter).m_index=nbD++;
00137       quantIter++;
00138     }
00139     <span class="keywordflow">else</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.erase(quantIter);
00140   }<span class="comment">/* loop on quantities */</span>
00141   <span class="comment">/* now that index have changed, update the index shortcuts */</span>
00142   <span class="keywordflow">for</span> (nbA=0; nbA&lt;<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>; nbA++) {
00143     <span class="keywordflow">if</span> (Catalog::s_CatalogList[2*nbA+1] == <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>) <span class="keywordflow">break</span>;
00144   }
00145   <a class="code" href="classcatalog_access_1_1_catalog.html#c10">setGeneric</a>(nbA);
00146 }
00147 <span class="comment">/**********************************************************************/</span>
00148 <span class="comment">// Copy constructor needed to allocate arrays in copy</span>
<a name="l00149"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a2">00149</a> Catalog::Catalog(<span class="keyword">const</span> <a class="code" href="classcatalog_access_1_1_catalog.html">Catalog</a> &amp; myCat) {
00150 
00151 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00152 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG Catalog COPY constructor on: "</span>
00153             &lt;&lt; myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> &lt;&lt; std::endl;
00154 <span class="preprocessor">  #endif  </span>
00155 <span class="preprocessor"></span>  std::string errText;
00156   <span class="comment">// copying values</span>
00157   <a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>;
00158   <a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a>;
00159   <a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>;
00160   <a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>    =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>;
00161   <a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>;
00162   <a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>;
00163   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>;
00164   <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>;
00165   <a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numReadRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o15">m_numReadRows</a>;
00166 <span class="comment">//  if ( myCat.myFile.is_open() ) { DO NOT COMPILE</span>
00167   <span class="keywordflow">if</span> ( myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a> &gt; 0 ) {
00168     <span class="comment">// the file read is left opened, don't know how to get stream on same file</span>
00169     errText=<span class="stringliteral">"FILE isn't CLOSED (in this version), FORBIDS importSelected"</span>;
00170     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00171   }
00172   <a class="code" href="classcatalog_access_1_1_catalog.html#o7">m_filePos</a>=0;
00173   <a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o8">m_posErrSys</a>;
00174   <a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
00175   <a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_selection</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o18">m_selection</a>;
00176   <a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_criteriaORed</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o19">m_criteriaORed</a>;
00177   <span class="comment">// following three data members needed for efficient selection</span>
00178   <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>;
00179   <a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>;
00180   <a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>   =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>;
00181   <a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>  =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>;
00182 
00183   <span class="comment">// copying elliptical region definition</span>
00184   <a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selRegion</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o20">m_selRegion</a>;
00185   <a class="code" href="classcatalog_access_1_1_catalog.html#o21">m_selEllipseCentRA_deg</a> =myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o21">m_selEllipseCentRA_deg</a>;
00186   <a class="code" href="classcatalog_access_1_1_catalog.html#o22">m_selEllipseCentDEC_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o22">m_selEllipseCentDEC_deg</a>;
00187   <a class="code" href="classcatalog_access_1_1_catalog.html#o23">m_selEllipseMinAxis_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o23">m_selEllipseMinAxis_deg</a>;
00188   <a class="code" href="classcatalog_access_1_1_catalog.html#o24">m_selEllipseMajAxis_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o24">m_selEllipseMajAxis_deg</a>;
00189   <a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_selEllipseRot_deg</a>=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o25">m_selEllipseRot_deg</a>;
00190 
00191   <span class="comment">// copying vectors</span>
00192 <span class="comment">//try {</span>
00193   <span class="keywordtype">long</span> i;
00194   <span class="keywordtype">int</span> vecSize, j;
00195   <span class="comment">// following data member m_selEllipse[] needed for efficient selection</span>
00196   <span class="keywordflow">try</span> {
00197     vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.size(); <span class="comment">// size is only 7</span>
00198     <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) <a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o30">m_selEllipse</a>.at(j));
00199   }
00200   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00201     errText=std::string(<span class="stringliteral">"EXCEPTION on m_selEllipse[]: "</span>)+err.what();
00202     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00203     <span class="keywordflow">throw</span>;
00204   }
00205   <span class="comment">// following data member m_loadQuantity[] needed for importSelected()</span>
00206   <span class="keywordflow">try</span> {
00207     vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.size();
00208     <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.reserve(vecSize);  <span class="comment">// pre-allocate the memory </span>
00209     <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++)
00210       <a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o11">m_loadQuantity</a>.at(j));
00211   }
00212   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00213     errText=std::string(<span class="stringliteral">"EXCEPTION on m_loadQuantity[]: "</span>)+err.what();
00214     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00215     <span class="keywordflow">throw</span>;
00216   }
00217   <span class="keywordflow">try</span> {
00218     std::vector&lt;Quantity&gt;::const_iterator itQ;
00219     <span class="keywordflow">for</span> (itQ=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.begin(); itQ!=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.end(); itQ++)
00220       <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.push_back(*itQ);
00221   }
00222   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00223     errText=std::string(<span class="stringliteral">"EXCEPTION on m_quantities[]: "</span>)+err.what();
00224     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00225     <span class="keywordflow">throw</span>;
00226   }
00227   <span class="comment">// suppose that each column has same number of rows</span>
00228   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.size();
00229   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00230     <span class="keywordflow">try</span> {
00231       <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>.resize(vecSize);
00232       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00233         <span class="comment">// pre-allocate the memory for each vector</span>
00234         <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>);
00235         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++)
00236           <a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[j].at(i));
00237       }
00238     }
00239     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00240       errText=std::string(<span class="stringliteral">"EXCEPTION on m_rowIsSelected[][]: "</span>)+err.what();
00241       <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00242       <span class="keywordflow">throw</span>;
00243     }
00244   }
00245   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.size();
00246   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00247     <span class="keywordflow">try</span> {
00248       <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>.resize(vecSize);
00249       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00250         <span class="comment">// pre-allocate the memory for each vector</span>
00251         <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>);
00252         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++)
00253           <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[j].at(i));
00254       }
00255     }
00256     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00257       errText=std::string(<span class="stringliteral">"EXCEPTION on m_strings[][]: "</span>)+err.what();
00258       <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00259       <span class="keywordflow">throw</span>;
00260     }
00261   }
00262   vecSize=myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.size();
00263   <span class="keywordflow">if</span> (vecSize &gt; 0 ) {
00264     <span class="keywordflow">try</span> {
00265       <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>.resize(vecSize);
00266       <span class="keywordflow">for</span> (j=0; j&lt;vecSize; j++) {
00267         <span class="comment">// pre-allocate the memory for each vector</span>
00268         <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].reserve(<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>);
00269         <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++)
00270           <a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].push_back(myCat.<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[j].at(i));
00271       }
00272     }
00273     <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00274       errText=std::string(<span class="stringliteral">"EXCEPTION on m_numericals[][]: "</span>)+err.what();
00275       <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"Catalog copy constructor"</span>, errText);
00276       <span class="keywordflow">throw</span>;
00277     }
00278   }
00279 <span class="comment">/* line is commented on purpose to TEMINATE the program on EXCEPTION */</span>
00280 <span class="comment">//} catch (...) { printErr("Catalog copy constructor", ""); }</span>
00281 }
00282 
00283 
00284 <span class="comment">/**********************************************************************/</span>
00285 <span class="comment">/*  METHODS giving GENERAL INFORMATION                                */</span>
00286 <span class="comment">/**********************************************************************/</span>
00287 <span class="comment">// return a list of all supported catalog names</span>
<a name="l00288"></a><a class="code" href="classcatalog_access_1_1_catalog.html#d0">00288</a> <span class="keywordtype">void</span> Catalog::getCatList(std::vector&lt;std::string&gt; *names, <span class="keyword">const</span> <span class="keywordtype">bool</span> isCode) {
00289 
00290   names-&gt;clear();
00291 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00292 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG number of known catalogs: "</span> &lt;&lt; <a class="code" href="catalog_8h.html#a0">MAX_CAT</a>
00293             &lt;&lt; std::endl;
00294 <span class="preprocessor">  #endif</span>
00295 <span class="preprocessor"></span>  std::string text;
00296   <span class="keywordtype">int</span> j=1;
00297   <span class="keywordflow">if</span> (isCode) j=0;
00298   <span class="keywordflow">try</span> {
00299     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="catalog_8h.html#a0">MAX_CAT</a>; i++) {
00300       text=Catalog::s_CatalogList[2*i+j]; <span class="comment">/* convert C string to C++ string */</span>
00301       names-&gt;push_back(text);
00302     }
00303   }
00304   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;prob) {
00305     text=std::string(<span class="stringliteral">"EXCEPTION filling names: "</span>)+prob.what();
00306     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"getCatList"</span>, text);
00307     <span class="keywordflow">throw</span>;
00308   }
00309 }
00310 <span class="comment">/**********************************************************************/</span>
00311 <span class="comment">// return a list of all supported web site names</span>
<a name="l00312"></a><a class="code" href="classcatalog_access_1_1_catalog.html#d1">00312</a> <span class="keywordtype">void</span> Catalog::getWebList(std::vector&lt;std::string&gt; *names, <span class="keyword">const</span> <span class="keywordtype">bool</span> isCode) {
00313 
00314   names-&gt;clear();
00315 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00316 <span class="preprocessor"></span>  std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG number of web sites: "</span> &lt;&lt; <a class="code" href="catalog_8h.html#a2">MAX_URL</a>
00317             &lt;&lt; std::endl;
00318 <span class="preprocessor">  #endif</span>
00319 <span class="preprocessor"></span>  std::string text;
00320   <span class="keywordflow">try</span> {
00321     std::string s;
00322     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos;
00323     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="catalog_8h.html#a2">MAX_URL</a>; i++) {
00324       s=Catalog::s_CatalogURL[i]; <span class="comment">/* convert C string to C++ string */</span>
00325       <span class="keywordflow">if</span> (isCode) {
00326         pos=s.find(<span class="charliteral">' '</span>);
00327         <span class="keywordflow">if</span> (pos == std::string::npos) text=<span class="stringliteral">""</span>;
00328         <span class="keywordflow">else</span> text=s.substr(0, pos);
00329       }
00330       <span class="keywordflow">else</span> {
00331         pos=s.rfind(<span class="charliteral">' '</span>);
00332         <span class="keywordflow">if</span> (pos == std::string::npos) text=s;
00333         <span class="keywordflow">else</span> text=s.substr(pos+1, s.length()-pos);
00334       }
00335       names-&gt;push_back(text);
00336     }
00337   }
00338   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;prob) {
00339     text=std::string(<span class="stringliteral">"EXCEPTION filling names: "</span>)+prob.what();
00340     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(<span class="stringliteral">"getWebList"</span>, text);
00341     <span class="keywordflow">throw</span>;
00342   }
00343 }
00344 
00345 <span class="comment">/**********************************************************************/</span>
00346 <span class="comment">// to know the maximal number of rows in the file</span>
<a name="l00347"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a3">00347</a> <span class="keywordtype">int</span> Catalog::getMaxNumRows(<span class="keywordtype">long</span> *nrows, <span class="keyword">const</span> std::string &amp;fileName) {
00348 
00349   <span class="keywordtype">int</span> i, err;
00350   std::string text, origin=<span class="stringliteral">"getMaxNumRows"</span>;
00351   *nrows=0;
00352   err=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">false</span>);
00353   <span class="comment">// after this check, m_numReadRows is 0</span>
00354   <span class="keywordflow">if</span> (err &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> err;
00355 
00356   <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=0;
00357   i=fileName.length();
00358   <span class="keywordflow">if</span> (i == 0) {
00359     text=<span class="stringliteral">": FILENAME is EMPTY"</span>;
00360     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00361     err=<a class="code" href="namespacecatalog_access.html#a35a16">BAD_FILENAME</a>;
00362     <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=err;
00363     <span class="keywordflow">return</span> err;
00364   }
00365   <span class="keywordflow">if</span> (fileName.at(i-1) == <span class="charliteral">']'</span>) {
00366     <span class="comment">// file should be a fits;</span>
00367  
00368     text=<span class="stringliteral">": fits FILE not handled now"</span>;
00369     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00370     err=<a class="code" href="namespacecatalog_access.html#a35a17">BAD_FILETYPE</a>;
00371     <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=err;
00372     <span class="keywordflow">return</span> err;
00373   }
00374   <span class="keywordflow">else</span> {
00375 
00376     std::ostringstream sortie;
00377     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tot=0ul; <span class="comment">// number of lines read</span>
00378     <span class="keywordtype">bool</span> testCR=<span class="keyword">false</span>; <span class="comment">// true if lines ends with CR (on windows)</span>
00379     <span class="keywordtype">int</span> what=0;        <span class="comment">// 0 for unkwown, &gt;0 for csv, &lt;0 to tsv</span>
00380                        <span class="comment">// fabs()=1 for standard, =2 for meta QUERY</span>
00381 
00382     <span class="keywordflow">if</span> ( <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.is_open() ) <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.close();
00383     <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.open(fileName.c_str(), std::ios::in);
00384     <span class="comment">// file can be opened ?</span>
00385     <span class="keywordflow">if</span> ( !<a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.is_open() ) {
00386       text=<span class="stringliteral">": FILENAME \""</span>+fileName+<span class="stringliteral">"\" cannot be opened"</span>;
00387       <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00388       err=<a class="code" href="namespacecatalog_access.html#a35a16">BAD_FILENAME</a>;
00389       <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>=err;
00390       <span class="keywordflow">return</span> err;
00391     }
00392 <span class="comment">/*    DIR *testDir=opendir(fileName.c_str());</span>
00393 <span class="comment">    if (testDir != NULL) {</span>
00394 <span class="comment">      closedir(testDir);</span>
00395 <span class="comment">      myFile.close();</span>
00396 <span class="comment">      text=": FILENAME \""+fileName+"\" is a directory";</span>
00397 <span class="comment">      printErr(origin, text);</span>
00398 <span class="comment">      err=BAD_FILETYPE;</span>
00399 <span class="comment">      m_numRows=err;</span>
00400 <span class="comment">      return err;</span>
00401 <span class="comment">    }*/</span>
00402     err=<a class="code" href="classcatalog_access_1_1_catalog.html#c15">analyze_head</a>(&amp;tot, &amp;what, &amp;testCR);
00403     <span class="keywordflow">if</span> (!tot) {
00404       text=<span class="stringliteral">": FILENAME \""</span>+fileName+<span class="stringliteral">"\" is fits without extension[] specified"</span>;
00405       <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00406       <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>) err=<a class="code" href="namespacecatalog_access.html#a35a16">BAD_FILENAME</a>;
00407       <span class="comment">// in case, for strange reason, file.good() fails at first time</span>
00408     }
00409     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err &lt; <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>) {
00410       sortie &lt;&lt; <span class="stringliteral">": FILENAME \""</span> &lt;&lt; fileName &lt;&lt; <span class="stringliteral">"\" is empty or "</span>
00411              &lt;&lt; <span class="stringliteral">"has unknown structure (stopped step "</span> &lt;&lt; -1*err &lt;&lt; <span class="stringliteral">")"</span>;
00412       <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, sortie.str());
00413       sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00414       <span class="keywordflow">if</span> (err == 0) err=<a class="code" href="namespacecatalog_access.html#a35a16">BAD_FILENAME</a>; <span class="comment">/* nothing is read */</span>
00415       <span class="keywordflow">else</span> err=<a class="code" href="namespacecatalog_access.html#a35a17">BAD_FILETYPE</a>; <span class="comment">/* can search if catalog name exist */</span>
00416     }
00417     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (what == 2) {
00418       sortie &lt;&lt; <span class="stringliteral">"closing input META file ("</span> &lt;&lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o14">m_numOriRows</a>;
00419       sortie &lt;&lt; <span class="stringliteral">" rows in whole CDS catalog)"</span>;
00420       <a class="code" href="namespacecatalog_access.html#a34">printLog</a>(0, sortie.str());
00421     }
00422     <span class="keywordflow">else</span> {
00423       <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> refRow=0ul;
00424       <span class="comment">// get columns description and units, data</span>
00425       err=<a class="code" href="classcatalog_access_1_1_catalog.html#c16">analyze_body</a>(&amp;tot, &amp;what, testCR, <span class="keyword">true</span>);
00426       <span class="comment">// only possible error: found &lt; 4</span>
00427       <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>) {
00428         <span class="comment">// decription is read until separation line starting with ---</span>
00429         <span class="keywordtype">char</span> line[<a class="code" href="catalog_8h.html#a3">MAX_LINE</a>];
00430         <span class="keywordtype">int</span>  posC,
00431              maxLine=<a class="code" href="catalog_8h.html#a3">MAX_LINE</a>-1; <span class="comment">// to avoid computation each line</span>
00432         refRow=tot+1;
00433         <span class="keywordflow">while</span> ( <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.good() ) {
00434           <a class="code" href="classcatalog_access_1_1_catalog.html#o6">myFile</a>.getline(line, <a class="code" href="catalog_8h.html#a3">MAX_LINE</a>);
00435           tot++;
00436           i=strlen(line);
00437           <span class="keywordflow">if</span> (i &lt; 2) <span class="keywordflow">break</span>; <span class="comment">// in any case, stop on empty string contrary to</span>
00438                             <span class="comment">//  load() which continues, skipping lines</span>
00439           <span class="comment">// string max size is MAX_LINE-1;</span>
00440           <span class="keywordflow">if</span> (i &gt;= maxLine) {
00441             sortie &lt;&lt; <span class="stringliteral">"line #"</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">" exceeds maximal size ("</span>
00442                    &lt;&lt; <a class="code" href="catalog_8h.html#a3">MAX_LINE</a> &lt;&lt; <span class="stringliteral">")"</span>;
00443             <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, sortie.str());
00444             sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00445             err=<a class="code" href="namespacecatalog_access.html#a35a19">BAD_FILELINE</a>;
00446             <span class="keywordflow">break</span>;
00447           }
00448           <span class="comment">//if (testCR) line[--i]='\0';</span>
00449           posC=strncmp(line, <span class="stringliteral">"#Table"</span>, 6);
00450           <span class="keywordflow">if</span> (posC == 0) {
00451             <span class="comment">// should not happen, normally preceded by empty lines</span>
00452             sortie &lt;&lt; <span class="stringliteral">"line #"</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">": second table start (not read)"</span>;
00453             <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, sortie.str());
00454             sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00455             err=<a class="code" href="namespacecatalog_access.html#a35a22">BAD_ROW</a>;
00456             <span class="keywordflow">break</span>;
00457           }
00458         }
00459         <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a35a22">BAD_ROW</a>) err=<a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00460       }<span class="comment">// analyze_body() is OK</span>
00461  
00462       <span class="keywordflow">if</span> ((err &lt; IS_OK) &amp;&amp; (err &gt;= -3)) {
00463         sortie &lt;&lt; <span class="stringliteral">": FILENAME \""</span> &lt;&lt; fileName
00464             &lt;&lt; <span class="stringliteral">"\" has unknown type (stopped step "</span> &lt;&lt; 5-1*err &lt;&lt; <span class="stringliteral">")"</span>;
00465         <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, sortie.str());
00466         sortie.str(<span class="stringliteral">""</span>); <span class="comment">// Will empty the string.</span>
00467         err=<a class="code" href="namespacecatalog_access.html#a35a17">BAD_FILETYPE</a>;
00468       }
00469       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (err == <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>) *nrows=tot-refRow;
00470       sortie &lt;&lt; <span class="stringliteral">"closing input text file: "</span> &lt;&lt; tot &lt;&lt; <span class="stringliteral">" lines read"</span>;
00471       <a class="code" href="namespacecatalog_access.html#a34">printLog</a>(0, sortie.str());
00472     }<span class="comment">// analyze_head() is OK</span>
00473 
00474   }<span class="comment">// file is read</span>
00475 
00476   <a class="code" href="classcatalog_access_1_1_catalog.html#c0">deleteDescription</a>(); <span class="comment">// close input file if left opened</span>
00477   <span class="keywordflow">return</span> err;
00478 }
00479 <span class="comment">/**********************************************************************/</span>
00480 <span class="comment">// to know the maximal number of rows in the CDS catalog</span>
<a name="l00481"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a4">00481</a> <span class="keywordtype">int</span> Catalog::getMaxNumRowsWeb(<span class="keywordtype">long</span> *nrows, <span class="keyword">const</span> std::string catName,
00482                               <span class="keyword">const</span> std::string urlCode) {
00483 
00484   <span class="keywordtype">int</span> i, err;
00485   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos;
00486   std::string web, text, origin=<span class="stringliteral">"getMaxNumRowsWeb"</span>;
00487   *nrows=0;
00488   err=<a class="code" href="namespacecatalog_access.html#a35a20">BAD_URL</a>;
00489   <span class="keywordflow">if</span> (urlCode.length() == 0) {
00490     text=<span class="stringliteral">": CODE for URL (web http address) is empty"</span>;
00491     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00492     <span class="keywordflow">return</span> err;
00493   }
00494   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="catalog_8h.html#a2">MAX_URL</a>; i++) {
00495     text=Catalog::s_CatalogURL[i]; <span class="comment">/* convert C string to C++ string */</span>
00496     pos=text.find(<span class="charliteral">' '</span>);
00497     <span class="keywordflow">if</span> (pos == std::string::npos) <span class="keywordflow">continue</span>;
00498     <span class="keywordflow">if</span> (text.substr(0, pos) == urlCode) <span class="keywordflow">break</span>;
00499   }
00500   <span class="keywordflow">if</span> (i == <a class="code" href="catalog_8h.html#a2">MAX_URL</a>) {
00501     text=<span class="stringliteral">": CODE for URL (web http address) do not exist"</span>;
00502     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00503     <span class="keywordflow">return</span> err;
00504   }
00505   pos=text.rfind(<span class="charliteral">' '</span>);
00506   <span class="keywordflow">if</span> (pos == std::string::npos) web=text;
00507   <span class="keywordflow">else</span> web=text.substr(pos+1, text.length()-pos);
00508 
00509   <span class="keywordtype">int</span> iCat=<a class="code" href="classcatalog_access_1_1_catalog.html#c23">checkCatName</a>(origin, catName);
00510   <span class="keywordflow">if</span> (iCat &lt; 0) <span class="keywordflow">return</span> iCat;
00511 
00512 <span class="comment">/* IS IT REALLY NEEDED ?</span>
00513 <span class="comment">  err=checkImport(origin, false);</span>
00514 <span class="comment">  if (err &lt; IS_VOID) return err;</span>
00515 <span class="comment">*/</span>
00516 <span class="comment">/* now, ASCII query must be created</span>
00517 <span class="comment">  and sent, using CDS package to given URL</span>
00518 <span class="comment">*/</span>
00519   err=-9;
00520   text=<span class="stringliteral">"Web query not implemented"</span>;
00521   <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00522 
00523   <span class="keywordflow">return</span> err;
00524 }
00525 
00526 
00527 <span class="comment">/**********************************************************************/</span>
00528 <span class="comment">/*  ACCESSING Catalog DEFINITION                                      */</span>
00529 <span class="comment">/**********************************************************************/</span>
00530 <span class="comment">// get the 3 definition strings</span>
<a name="l00531"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a15">00531</a> <span class="keywordtype">void</span> Catalog::getCatalogTitles(std::vector&lt;std::string&gt; *titles) {
00532 
00533   <span class="keywordtype">int</span> nb=titles-&gt;size();
00534   <span class="keywordflow">if</span> (nb == 0) titles-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>);
00535   <span class="keywordflow">else</span> (*titles)[0]=<a class="code" href="classcatalog_access_1_1_catalog.html#o0">m_code</a>;
00536   <span class="keywordflow">if</span> (nb &gt; 1) (*titles)[1]=<a class="code" href="classcatalog_access_1_1_catalog.html#o1">m_URL</a>;       <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00537   <span class="keywordflow">if</span> (nb &gt; 2) (*titles)[2]=<a class="code" href="classcatalog_access_1_1_catalog.html#o2">m_catName</a>;   <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00538   <span class="keywordflow">if</span> (nb &gt; 3) (*titles)[3]=<a class="code" href="classcatalog_access_1_1_catalog.html#o3">m_catRef</a>;    <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00539   <span class="keywordflow">if</span> (nb &gt; 4) (*titles)[4]=<a class="code" href="classcatalog_access_1_1_catalog.html#o4">m_tableName</a>; <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00540   <span class="keywordflow">if</span> (nb &gt; 5) (*titles)[5]=<a class="code" href="classcatalog_access_1_1_catalog.html#o5">m_tableRef</a>;  <span class="keywordflow">else</span> <span class="keywordflow">return</span>;
00541 }
00542 
00543 <span class="comment">/**********************************************************************/</span>
00544 <span class="comment">// get an iterator on the quantities</span>
00545 
00546 
00547 <span class="comment">/**********************************************************************/</span>
00548 <span class="comment">// get a copy of the quantity vector</span>
<a name="l00549"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a16">00549</a> <span class="keywordtype">int</span> Catalog::getQuantityDescription(std::vector&lt;Quantity&gt; *myQuantities) {
00550 
00551   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(<span class="stringliteral">"getQuantityDescription"</span>, <span class="keyword">true</span>);
00552   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) {
00553     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getQuantityDescription"</span>, <span class="stringliteral">"returning unchanged vector."</span>);
00554     <span class="keywordflow">return</span> quantSize;
00555   }
00556   *myQuantities=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>;
00557   <span class="keywordflow">return</span> quantSize;
00558 }
00559 
00560 <span class="comment">/**********************************************************************/</span>
00561 <span class="comment">// get only Quantity member name</span>
<a name="l00562"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a17">00562</a> <span class="keywordtype">int</span> Catalog::getQuantityNames(std::vector&lt;std::string&gt; *names) {
00563 
00564   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityNames"</span>;
00565   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
00566   names-&gt;clear();
00567   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) {
00568     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00569     <span class="keywordflow">return</span> quantSize;
00570   }
00571   <span class="keywordflow">try</span> {
00572     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00573       names-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_name);
00574   }
00575   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00576     std::string errText;
00577     errText=std::string(<span class="stringliteral">"EXCEPTION on names: "</span>)+err.what();
00578     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, errText);
00579     <span class="keywordflow">throw</span>;
00580   }
00581   <span class="keywordflow">return</span> quantSize;
00582 }
00583 <span class="comment">/**********************************************************************/</span>
00584 <span class="comment">// get only Quantity member unit</span>
<a name="l00585"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a18">00585</a> <span class="keywordtype">int</span> Catalog::getQuantityUnits(std::vector&lt;std::string&gt; *units) {
00586 
00587   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityUnits"</span>;
00588   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
00589   units-&gt;clear();
00590   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) {
00591     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00592     <span class="keywordflow">return</span> quantSize;
00593   } 
00594   <span class="keywordflow">try</span> {
00595     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00596       units-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_unit);
00597   }
00598   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00599     std::string errText;
00600     errText=std::string(<span class="stringliteral">"EXCEPTION on units: "</span>)+err.what();
00601     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, errText);
00602     <span class="keywordflow">throw</span>;
00603   }
00604   <span class="keywordflow">return</span> quantSize;
00605 }
00606 <span class="comment">/**********************************************************************/</span>
00607 <span class="comment">// get only Quantity member ucd</span>
<a name="l00608"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a19">00608</a> <span class="keywordtype">int</span> Catalog::getQuantityUCDs (std::vector&lt;std::string&gt; *ucds) {
00609 
00610   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityUCDs"</span>;
00611   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
00612   ucds-&gt;clear();
00613   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) {
00614     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00615     <span class="keywordflow">return</span> quantSize;
00616   } 
00617   <span class="keywordflow">try</span> {
00618     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00619       ucds-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_ucd);
00620   }
00621   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00622     std::string errText;
00623     errText=std::string(<span class="stringliteral">"EXCEPTION on ucds: "</span>)+err.what();
00624     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, errText);
00625     <span class="keywordflow">throw</span>;
00626   }
00627   <span class="keywordflow">return</span> quantSize;
00628 }
00629 <span class="comment">/**********************************************************************/</span>
00630 <span class="comment">// get only Quantity member type</span>
<a name="l00631"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a20">00631</a> <span class="keywordtype">int</span> Catalog::getQuantityTypes(std::vector&lt;Quantity::QuantityType&gt; *types) {
00632 
00633   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getQuantityTypes"</span>;
00634   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
00635   types-&gt;clear();
00636   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) {
00637     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"returning empty vector."</span>);
00638     <span class="keywordflow">return</span> quantSize;
00639   } 
00640   <span class="keywordflow">try</span> {
00641     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;quantSize; i++)
00642       types-&gt;push_back(<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(i).m_type);
00643   }
00644   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00645     std::string errText;
00646     errText=std::string(<span class="stringliteral">"EXCEPTION on types: "</span>)+err.what();
00647     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, errText);
00648     <span class="keywordflow">throw</span>;
00649   }
00650   <span class="keywordflow">return</span> quantSize;
00651 }
00652 
00653 <span class="comment">/**********************************************************************/</span>
00654 <span class="comment">// get the member "statErrName" of given quantity "name"</span>
<a name="l00655"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a21">00655</a> <span class="keywordtype">int</span> Catalog::getStatErrorName(<span class="keyword">const</span> std::string name,
00656                               std::string *statErrName) {
00657 
00658   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(<span class="stringliteral">"getStatErrorName"</span>, <span class="keyword">true</span>);
00659   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> quantSize;
00660   quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(<span class="stringliteral">"getStatErrorName"</span>, name);
00661   <span class="keywordflow">if</span> (quantSize &lt; 0) <span class="keywordflow">return</span> quantSize;
00662   *statErrName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(quantSize).m_statError;
00663   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00664 }
00665 <span class="comment">/**********************************************************************/</span>
00666 <span class="comment">// get the member "sysErrName" of given quantity "name"</span>
<a name="l00667"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a22">00667</a> <span class="keywordtype">int</span> Catalog::getSysErrorName(<span class="keyword">const</span> std::string name,
00668                              std::string *sysErrName) {
00669 
00670   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(<span class="stringliteral">"getSysErrorName"</span>, <span class="keyword">true</span>);
00671   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> quantSize;
00672   quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(<span class="stringliteral">"getSysErrorName"</span>, name);
00673   <span class="keywordflow">if</span> (quantSize &lt; 0) <span class="keywordflow">return</span> quantSize;
00674   *sysErrName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(quantSize).m_sysError;
00675   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00676 }
00677   
00678 <span class="comment">/**********************************************************************/</span>
00679 <span class="comment">// get the list of names of the quantities which form the given vector "name"</span>
00680 
00681 
00682 
00683 <span class="comment">/**********************************************************************/</span>
00684 <span class="comment">/*  ACCESSING ALL Catalog CONTENTS in MEMORY (IGNORING SELECTION)     */</span>
00685 <span class="comment">/**********************************************************************/</span>
00686 <span class="comment">// get the number of rows in the catalog</span>
<a name="l00687"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a24">00687</a> <span class="keywordtype">void</span> Catalog::getNumRows(<span class="keywordtype">long</span> *nrows) {
00688 
00689   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0) *nrows=0;
00690   <span class="keywordflow">else</span> *nrows=<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>;
00691 }
00692 
00693 <span class="comment">/**********************************************************************/</span>
00694 <span class="comment">// get the value of given string quantity in given row</span>
<a name="l00695"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a25">00695</a> <span class="keywordtype">int</span> Catalog::getSValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00696                        std::string *stringVal) {
00697 
00698   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSValue"</span>;
00699   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
00700   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00701   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00702   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00703   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00704     std::string errText;
00705     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00706     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00707     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00708   }
00709   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00710 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00711 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG STRING index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00712 <span class="preprocessor">  #endif</span>
00713 <span class="preprocessor"></span>  *stringVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(row);
00714   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00715 }
00716 <span class="comment">/**********************************************************************/</span>
00717 <span class="comment">// get the value of given numerical quantity in given row</span>
<a name="l00718"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a26">00718</a> <span class="keywordtype">int</span> Catalog::getNValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00719                        <span class="keywordtype">double</span> *realVal) {
00720 
00721   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNValue"</span>;
00722   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
00723   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00724   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00725   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00726   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {  
00727     std::string errText;
00728     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00729     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00730     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00731   }
00732   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00733 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00734 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00735 <span class="preprocessor">  #endif</span>
00736 <span class="preprocessor"></span>  *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00737   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00738 }
00739 
00740 <span class="comment">/**********************************************************************/</span>
00741 <span class="comment">// get the values of given vector quantity in given row</span>
00742 
00743 <span class="comment">/**********************************************************************/</span>
00744 <span class="comment">// get the value of the statistical error of given quantity in given row</span>
<a name="l00745"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a27">00745</a> <span class="keywordtype">int</span> Catalog::getStatError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00746                           <span class="keywordtype">double</span> *realValStat) {
00747 
00748   *realValStat = -1.0;
00749   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getStatError"</span>;
00750   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
00751   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00752   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00753   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00754   std::string statName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_statError;
00755   <span class="keywordflow">if</span> (statName.empty()) {;
00756     statName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no statistical error"</span>;
00757     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, statName);
00758     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a25">NO_QUANT_ERR</a>;
00759   }
00760   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, statName);
00761   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00762   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00763 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00764 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM STAT index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00765 <span class="preprocessor">  #endif</span>
00766 <span class="preprocessor"></span>  *realValStat=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00767   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00768 }
00769 <span class="comment">/**********************************************************************/</span>
00770 <span class="comment">// get the value of the systematic error of given quantity in given row</span>
<a name="l00771"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a28">00771</a>   <span class="keywordtype">int</span> Catalog::getSysError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> row,
00772                            <span class="keywordtype">double</span> *realValSys) {
00773 
00774   *realValSys = -1.0;
00775   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSysError"</span>;
00776   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
00777   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00778   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00779   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00780   std::string sysName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_sysError;
00781   <span class="keywordflow">if</span> (sysName.empty()) {
00782     sysName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no systematic error"</span>;
00783     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, sysName);
00784     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a25">NO_QUANT_ERR</a>;
00785   }
00786   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, sysName);
00787   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00788   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00789 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00790 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM SYS. index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00791 <span class="preprocessor">  #endif</span>
00792 <span class="preprocessor"></span>  *realValSys=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
00793   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00794 }
00795 
00796 <span class="comment">/**********************************************************************/</span>
00797 <span class="comment">// get the values of the statistical error of given vector in given row</span>
00798 
00799 <span class="comment">/**********************************************************************/</span>
00800 <span class="comment">// get the values of the systematic error of given vector in given row</span>
00801 
00802 
00803 <span class="comment">/**********************************************************************/</span>
00804 <span class="comment">// for string quantity: the list of different values assumed</span>
<a name="l00805"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a29">00805</a> <span class="keywordtype">int</span> Catalog::getSValues(<span class="keyword">const</span> std::string name,
00806                         std::vector&lt;std::string&gt; *values) {
00807 
00808   values-&gt;clear();
00809   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSValues"</span>;
00810   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, 0);
00811   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00812   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00813   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00814   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00815     std::string errText;
00816     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00817     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00818     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00819   }
00820   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00821   std::string text;
00822   <span class="keywordflow">try</span> {
00823     values-&gt;assign(1, <a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(0));
00824     <span class="keywordtype">long</span> i, j, max;
00825     <span class="keywordflow">for</span> (i=1; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) {
00826       text=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i);
00827       max=values-&gt;size();
00828       <span class="keywordflow">for</span> (j=0; j&lt;max; j++) <span class="keywordflow">if</span> (values-&gt;at(j) == text) <span class="keywordflow">break</span>;
00829       <span class="keywordflow">if</span> (j == max) values-&gt;push_back(text);
00830     }
00831   }
00832   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
00833     text=std::string(<span class="stringliteral">"EXCEPTION on values: "</span>)+err.what();
00834     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
00835     <span class="keywordflow">throw</span>;
00836   }
00837   <span class="keywordflow">return</span> values-&gt;size();
00838 }
00839 
00840 <span class="comment">/**********************************************************************/</span>
00841 <span class="comment">// for numerical quantity: the minimum value in the catalog</span>
<a name="l00842"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a30">00842</a> <span class="keywordtype">int</span> Catalog::minVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
00843 
00844   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
00845   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"minVal"</span>;
00846   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, 0);
00847   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00848   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00849   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00850   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
00851     std::string errText;
00852     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00853     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00854     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00855   }
00856   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00857   <span class="keywordtype">long</span> i=0;
00858   <span class="keywordtype">double</span> r;
00859   <span class="keywordflow">do</span> { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00860 <span class="comment">/*  std::cout &lt;&lt; "NaN == NaN ? " &lt;&lt; (*realVal == m_numericals[num].at(0))</span>
00861 <span class="comment">            &lt;&lt; std::endl;*/</span>
00862   }
00863   <span class="keywordflow">while</span> ((isnan(*realVal)) &amp;&amp; (++i &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>));
00864   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) {
00865     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00866     <span class="keywordflow">if</span> (r &lt; *realVal) *realVal=r;
00867   }
00868   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00869 }
00870 <span class="comment">/**********************************************************************/</span>
00871 <span class="comment">// for numerical quantity: the maximum value in the catalog</span>
<a name="l00872"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a31">00872</a> <span class="keywordtype">int</span> Catalog::maxVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
00873 
00874   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
00875   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"maxVal"</span>;
00876   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, 0);
00877   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00878   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00879   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00880   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
00881     std::string errText;
00882     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00883     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00884     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00885   }
00886   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00887   <span class="keywordtype">long</span> i=0;
00888   <span class="keywordtype">double</span> r;
00889   <span class="keywordflow">do</span> { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); }
00890   <span class="keywordflow">while</span> ((isnan(*realVal)) &amp;&amp; (++i &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>));
00891   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) {
00892     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
00893     <span class="keywordflow">if</span> (r &gt; *realVal) *realVal=r;
00894   }
00895   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00896 }
00897 
00898 
00899 <span class="comment">/**********************************************************************/</span>
00900 <span class="comment">/*  ACCESSING the Catalog CONTENTS with in-memory SELECTION CRITERIA  */</span>
00901 <span class="comment">/**********************************************************************/</span>
00902 <span class="comment">// get the number of selected rows in the catalog</span>
<a name="l00903"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a32">00903</a> <span class="keywordtype">void</span> Catalog::getNumSelRows(<span class="keywordtype">long</span> *nrows) {
00904 
00905  *nrows=<a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>;
00906 }
00907 
00908 <span class="comment">/**********************************************************************/</span>
00909 <span class="comment">// get the value of given string quantity in given selected row</span>
<a name="l00910"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a33">00910</a> <span class="keywordtype">int</span> Catalog::getSelSValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00911                           std::string *stringVal) {
00912 
00913   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSValue"</span>;
00914   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, srow);
00915   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00916   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00917   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00918   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00919   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
00920     std::string errText;
00921     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
00922     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00923     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00924   }
00925   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00926   <span class="keywordtype">long</span> tot=0;
00927   <span class="comment">// first bit indicates global selection</span>
00928   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00929     <span class="keywordflow">if</span> (tot == srow) { *stringVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i); <span class="keywordflow">break</span>; }
00930     tot++;
00931     <span class="comment">//if (tot == m_numSelRows) break; should not happen</span>
00932   }
00933   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00934   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
00935 }
00936 <span class="comment">/**********************************************************************/</span>
00937 <span class="comment">// get the value of given numerical quantity in given selected row</span>
<a name="l00938"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a34">00938</a> <span class="keywordtype">int</span> Catalog::getSelNValue(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00939                           <span class="keywordtype">double</span> *realVal) {
00940 
00941   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelNValue"</span>;
00942   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, srow);
00943   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00944   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00945   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00946   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00947   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {  
00948     std::string errText;
00949     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
00950     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
00951     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
00952   }
00953   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00954   <span class="keywordtype">long</span> tot=0;
00955   <span class="comment">// first bit indicates global selection</span>
00956   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00957     <span class="keywordflow">if</span> (tot == srow) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
00958     tot++;
00959     <span class="comment">//if (tot == m_numSelRows) break; should not happen</span>
00960   }
00961   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00962   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
00963 }
00964 
00965 <span class="comment">/**********************************************************************/</span>
00966 <span class="comment">// get the values of given vector quantity in given selected row</span>
00967 
00968 <span class="comment">/**********************************************************************/</span>
00969 <span class="comment">// get value of the statistical error of given quantity in given selected row</span>
<a name="l00970"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a35">00970</a> <span class="keywordtype">int</span> Catalog::getSelStatError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
00971                              <span class="keywordtype">double</span> *realValStat) {
00972 
00973   *realValStat = -1.0;
00974   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelStatError"</span>;
00975   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, srow);
00976   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
00977   <span class="comment">// above test avoid searching for srow when no row is selected</span>
00978   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
00979   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00980   std::string statName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_statError;
00981   <span class="keywordflow">if</span> (statName.empty()) {;
00982     statName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no statistical error"</span>;
00983     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, statName);
00984     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a25">NO_QUANT_ERR</a>;
00985   }
00986   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, statName);
00987   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
00988   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
00989 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
00990 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM STAT index = "</span> &lt;&lt; num &lt;&lt; std::endl;
00991 <span class="preprocessor">  #endif</span>
00992 <span class="preprocessor"></span>  <span class="keywordtype">long</span> tot=0;
00993   <span class="comment">// first bit indicates global selection</span>
00994   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
00995     <span class="keywordflow">if</span> (tot == srow) { *realValStat=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
00996     tot++;
00997   }
00998   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
00999   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
01000 }
01001 <span class="comment">/**********************************************************************/</span>
01002 <span class="comment">// get value of the systematic error of given quantity in given selected row</span>
<a name="l01003"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a36">01003</a> <span class="keywordtype">int</span> Catalog::getSelSysError(<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">long</span> srow,
01004                              <span class="keywordtype">double</span> *realValSys) {
01005 
01006   *realValSys = -1.0;
01007   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSysError"</span>;
01008   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, srow);
01009   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01010   <span class="comment">// above test avoid searching for srow when no row is selected</span>
01011   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
01012   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01013   std::string sysName=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_sysError;
01014   <span class="keywordflow">if</span> (sysName.empty()) {;
01015     sysName=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") has no systematic error"</span>;
01016     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, sysName);
01017     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a25">NO_QUANT_ERR</a>;
01018   }
01019   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, sysName);
01020   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01021   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01022 <span class="preprocessor">  #ifdef DEBUG_CAT</span>
01023 <span class="preprocessor"></span>    std::cout &lt;&lt; <span class="stringliteral">"!! DEBUG NUM SYS. index = "</span> &lt;&lt; num &lt;&lt; std::endl;
01024 <span class="preprocessor">  #endif</span>
01025 <span class="preprocessor"></span>  <span class="keywordtype">long</span> tot=0;
01026   <span class="comment">// first bit indicates global selection</span>
01027   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01028     <span class="keywordflow">if</span> (tot == srow) { *realValSys=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i); <span class="keywordflow">break</span>; }
01029     tot++;
01030   }
01031   <span class="keywordflow">if</span> (tot &lt; <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01032   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
01033 }
01034 <span class="comment">/**********************************************************************/</span>
01035 <span class="comment">// get the values of the statistical error of given vector in given selected row</span>
01036 
01037 <span class="comment">/**********************************************************************/</span>
01038 <span class="comment">// get the values of the systematic error of given vector in given selected row</span>
01039 
01040 
01041 <span class="comment">/**********************************************************************/</span>
01042 <span class="comment">// for string quantity: the list of different selected values assumed</span>
<a name="l01043"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a37">01043</a> <span class="keywordtype">int</span> Catalog::getSelSValues(<span class="keyword">const</span> std::string name,
01044                            std::vector&lt;std::string&gt; *values) {
01045 
01046   values-&gt;clear();
01047   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getSelSValues"</span>;
01048   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, 0);
01049   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01050   <span class="comment">// above test avoid searching when no row is selected</span>
01051   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
01052   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01053   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::STRING) {
01054     std::string errText;
01055     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of STRING type"</span>;
01056     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
01057     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
01058   }
01059   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01060   std::string text;
01061   <span class="keywordflow">try</span> {
01062     <span class="keywordtype">long</span> j, max=0, tot=0;
01063     <span class="comment">// first bit indicates global selection</span>
01064     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01065       text=<a class="code" href="classcatalog_access_1_1_catalog.html#o12">m_strings</a>[num].at(i);
01066       <span class="keywordflow">if</span> (max == 0) {values-&gt;assign(1, text); max++;}
01067       <span class="keywordflow">else</span> {
01068         <span class="keywordflow">for</span> (j=0; j&lt;max; j++) <span class="keywordflow">if</span> (values-&gt;at(j) == text) <span class="keywordflow">break</span>;
01069         <span class="keywordflow">if</span> (j == max) {values-&gt;push_back(text); max++;}
01070       }
01071       <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01072     }
01073   }
01074   <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;err) {
01075     text=std::string(<span class="stringliteral">"EXCEPTION on values: "</span>)+err.what();
01076     <a class="code" href="namespacecatalog_access.html#a32">printErr</a>(origin, text);
01077     <span class="keywordflow">throw</span>;
01078   }
01079   <span class="keywordflow">return</span> values-&gt;size();
01080 }
01081 
01082 <span class="comment">/**********************************************************************/</span>
01083 <span class="comment">// for numerical quantity: the minimum value in the selected rows</span>
<a name="l01084"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a38">01084</a> <span class="keywordtype">int</span> Catalog::minSelVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
01085 
01086   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
01087   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"minSelVal"</span>;
01088   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, 0);
01089   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01090   <span class="comment">// above test avoid searching when no row is selected</span>
01091   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
01092   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01093   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
01094     std::string errText;
01095     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
01096     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
01097     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
01098   }
01099   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01100 
01101   <span class="keywordtype">long</span> i, tot=0;
01102   <span class="keywordtype">double</span> r;
01103   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01104     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01105     <span class="keywordflow">if</span> (!isnan(*realVal)) <span class="keywordflow">break</span>;
01106     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01107   }
01108   <span class="keywordflow">if</span> (tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01109   <span class="comment">// stop when selection contains only NaN</span>
01110   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01111     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01112     <span class="keywordflow">if</span> (r &lt; *realVal) *realVal=r;
01113     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01114   }
01115   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01116 }
01117 <span class="comment">/**********************************************************************/</span>
01118 <span class="comment">// for numerical quantity: the maximum value in the selected rows</span>
<a name="l01119"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a39">01119</a> <span class="keywordtype">int</span> Catalog::maxSelVal(<span class="keyword">const</span> std::string name, <span class="keywordtype">double</span> *realVal) {
01120 
01121   *realVal=<a class="code" href="quantity_8h.html#a0">NO_SEL_CUT</a>;
01122   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"maxSelVal"</span>;
01123   <span class="keywordtype">int</span> num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, 0);
01124   <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01125   <span class="comment">// above test avoid searching when no row is selected</span>
01126   num=<a class="code" href="classcatalog_access_1_1_catalog.html#c25">checkQuant_name</a>(origin, name);
01127   <span class="keywordflow">if</span> (num &lt; 0) <span class="keywordflow">return</span> num;
01128   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_type != Quantity::NUM) {
01129     std::string errText;
01130     errText=<span class="stringliteral">"given Quantity name ("</span>+name+<span class="stringliteral">") is not of NUM type"</span>;
01131     <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, errText);
01132     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a24">BAD_QUANT_TYPE</a>;
01133   }
01134   num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>.at(num).m_index;
01135 
01136   <span class="keywordtype">long</span> i, tot=0;
01137   <span class="keywordtype">double</span> r;
01138   <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01139     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01140     <span class="keywordflow">if</span> (!isnan(*realVal)) <span class="keywordflow">break</span>;
01141     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01142   }
01143   <span class="keywordflow">if</span> (tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01144   <span class="comment">// stop when selection contains only NaN</span>
01145   <span class="keywordflow">for</span> (; i&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; i++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(i) &amp; 1) {
01146     r=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(i);
01147     <span class="keywordflow">if</span> (r &gt; *realVal) *realVal=r;
01148     <span class="keywordflow">if</span> (++tot == <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">break</span>; <span class="comment">// to speed up</span>
01149   }
01150   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01151 }
01152 
01153 
01154 <span class="comment">/**********************************************************************/</span>
01155 <span class="comment">/*  ACCESSING the Catalog GENERIC CONTENTS                            */</span>
01156 <span class="comment">/**********************************************************************/</span>
01157 <span class="comment">// access to generic quantity for RA  (degrees)</span>
<a name="l01158"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a40">01158</a> <span class="keywordtype">int</span> Catalog::ra_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal, <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01159 
01160   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"ra_deg"</span>;
01161   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a> &lt; 0) {
01162     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01163       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01164     <span class="keywordflow">else</span>
01165       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"missing generic RA position quantity"</span>);
01166     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a21">NO_RA_DEC</a>;
01167   }
01168   <span class="keywordtype">int</span> num;
01169   <span class="keywordflow">if</span> (!inSelection) {
01170     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
01171     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01172     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>].m_index;
01173     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
01174   }
01175   <span class="keywordflow">else</span> {
01176     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, row);
01177     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01178     <span class="keywordtype">long</span> tot=0;
01179     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>].m_index;
01180     <span class="comment">// first bit indicates global selection</span>
01181     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01182       <span class="keywordflow">if</span> (tot == row) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k); <span class="keywordflow">break</span>; }
01183       tot++;
01184     }
01185     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
01186   }
01187   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01188 }
01189 <span class="comment">/**********************************************************************/</span>
01190 <span class="comment">// access to generic quantity for DEC (degrees)</span>
<a name="l01191"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a41">01191</a> <span class="keywordtype">int</span> Catalog::dec_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal, <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01192 
01193   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"dec_deg"</span>;
01194   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a> &lt; 0) {
01195     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01196       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01197     <span class="keywordflow">else</span>
01198       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"missing generic DEC position quantity"</span>);
01199     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a21">NO_RA_DEC</a>;
01200   }
01201   <span class="keywordtype">int</span> num;
01202   <span class="keywordflow">if</span> (!inSelection) {
01203     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
01204     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01205     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>].m_index;
01206     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row);
01207   }
01208   <span class="keywordflow">else</span> {
01209     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, row);
01210     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01211     <span class="keywordtype">long</span> tot=0;
01212     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>].m_index;
01213     <span class="comment">// first bit indicates global selection</span>
01214     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01215       <span class="keywordflow">if</span> (tot == row) { *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k); <span class="keywordflow">break</span>; }
01216       tot++;
01217     }
01218     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
01219   }
01220   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01221 }
01222 <span class="comment">/**********************************************************************/</span>
01223 <span class="comment">// access to generic quantity for position uncertainty (degrees)</span>
<a name="l01224"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a42">01224</a> <span class="keywordtype">int</span> Catalog::posError_deg(<span class="keyword">const</span> <span class="keywordtype">long</span> row, <span class="keywordtype">double</span> *realVal,
01225                           <span class="keyword">const</span> <span class="keywordtype">bool</span> inSelection) {
01226 
01227   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"posError_deg"</span>;
01228   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a> &lt; 0) {
01229     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01230       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"must first use one 'import' method"</span>);
01231     <span class="keywordflow">else</span>
01232       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(origin, <span class="stringliteral">"missing generic position error quantity"</span>);
01233     <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a23">BAD_QUANT_NAME</a>;
01234   }
01235   <span class="keywordtype">int</span> num;
01236   <span class="keywordflow">if</span> (!inSelection) {
01237     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c24">checkSize_row</a>(origin, row);
01238     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01239     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>].m_index;
01240     *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(row)/<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
01241   }
01242   <span class="keywordflow">else</span> {
01243     num=<a class="code" href="classcatalog_access_1_1_catalog.html#c26">checkSel_row</a>(origin, row);
01244     <span class="keywordflow">if</span> (num &lt;= <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> num;
01245     <span class="keywordtype">long</span> tot=0;
01246     num=<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>].m_index;
01247     <span class="comment">// first bit indicates global selection</span>
01248     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> k=0; k&lt;<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a>; k++) <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o17">m_rowIsSelected</a>[0].at(k) &amp; 1) {
01249       <span class="keywordflow">if</span> (tot == row) {
01250         *realVal=<a class="code" href="classcatalog_access_1_1_catalog.html#o13">m_numericals</a>[num].at(k)/<a class="code" href="classcatalog_access_1_1_catalog.html#o9">m_posErrFactor</a>;
01251         <span class="keywordflow">break</span>;
01252       }
01253       tot++;
01254     }
01255     <span class="keywordflow">if</span> (tot &gt;= <a class="code" href="classcatalog_access_1_1_catalog.html#o26">m_numSelRows</a>) <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>; <span class="comment">// should not happen</span>
01256   }
01257   <span class="keywordflow">return</span> <a class="code" href="namespacecatalog_access.html#a35a11">IS_OK</a>;
01258 }
01259 
01260 <span class="comment">/**********************************************************************/</span>
01261 <span class="comment">// 6 methods returning the name of generic quantities</span>
<a name="l01262"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a43">01262</a> std::string Catalog::getNameRA() {
01263   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a> &lt; 0) {
01264     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01265       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getNameRA"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01266     <span class="keywordflow">else</span>
01267       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getNameRA"</span>, <span class="stringliteral">"missing generic RA position quantity"</span>);
01268     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01269   }
01270   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o28">m_indexRA</a>].m_name;
01271 }
<a name="l01272"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a44">01272</a> std::string Catalog::getNameDEC() {
01273   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a> &lt; 0) {
01274     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01275       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getNameDEC"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01276     <span class="keywordflow">else</span>
01277       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getNameDEC"</span>, <span class="stringliteral">"missing generic DEC position quantity"</span>);
01278     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01279   }
01280   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o29">m_indexDEC</a>].m_name;
01281 }
<a name="l01282"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a45">01282</a> std::string Catalog::getNamePosErr() {
01283   <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>&lt; 0) {
01284     <span class="keywordflow">if</span> (<a class="code" href="classcatalog_access_1_1_catalog.html#o16">m_numRows</a> &lt; 0)
01285       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getNamePosErr"</span>, <span class="stringliteral">"must first use one 'import' method"</span>);
01286     <span class="keywordflow">else</span>
01287       <a class="code" href="namespacecatalog_access.html#a33">printWarn</a>(<span class="stringliteral">"getNamePosErr"</span>, <span class="stringliteral">"missing generic position error quantity"</span>);
01288     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01289   }
01290   <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[<a class="code" href="classcatalog_access_1_1_catalog.html#o27">m_indexErr</a>].m_name;
01291 }
01292 
<a name="l01293"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a46">01293</a> std::string Catalog::getNameL() {
01294   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameL"</span>;
01295   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
01296   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01297   <span class="keywordtype">int</span> i;
01298   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01299     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01300         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_ucd == Catalog::s_genericL))
01301       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01302   }
01303   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01304 }
<a name="l01305"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a47">01305</a> std::string Catalog::getNameB() {
01306   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameB"</span>;
01307   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
01308   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01309   <span class="keywordtype">int</span> i;
01310   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01311     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01312         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_ucd == Catalog::s_genericB))
01313       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01314   }
01315   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01316 }
01317 
<a name="l01318"></a><a class="code" href="classcatalog_access_1_1_catalog.html#a48">01318</a> std::string Catalog::getNameObjName() {
01319   <span class="keyword">const</span> std::string origin=<span class="stringliteral">"getNameObjName"</span>;
01320   <span class="keywordtype">int</span> quantSize=<a class="code" href="classcatalog_access_1_1_catalog.html#c22">checkImport</a>(origin, <span class="keyword">true</span>);
01321   <span class="keywordflow">if</span> (quantSize &lt; <a class="code" href="namespacecatalog_access.html#a35a12">IS_VOID</a>) <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01322   <span class="keywordtype">int</span> i;
01323   <span class="keywordflow">for</span> (i=0; i&lt;quantSize; i++) {
01324     <span class="keywordflow">if</span> ((<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_isGeneric) &amp;&amp;
01325         (<a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_type == Quantity::STRING))
01326       <span class="keywordflow">return</span> <a class="code" href="classcatalog_access_1_1_catalog.html#o10">m_quantities</a>[i].m_name;
01327   }
01328   <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
01329 }
01330 
01331 } <span class="comment">// namespace catalogAccess</span>
</pre></div><hr><address style="align: right;"><small>Generated on Mon Jun 20 15:18:14 2005 for catalogAccess by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.18 </small></address>
</body>
</html>
